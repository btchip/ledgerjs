import {
  createTransportReplayer,
  RecordStore
} from "@ledgerhq/hw-transport-mocker";
import Btc from "../src/Btc";

test("btc.getWalletPublicKey", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
      => e040000011048000002c800000008000000000000000
      <= 410486b865b52b753d0a84d09bc20063fab5d8453ec33c215d4019a5801c9c6438b917770b2782e29a9ecc6edb67cd1f0fbf05ec4c1236884b6d686d6be3b1588abb2231334b453654666641724c683466564d36756f517a7673597135767765744a63564dbce80dd580792cd18af542790e56aa813178dc28644bb5f03dbd44c85f2d2e7a9000
    `)
  );
  const transport = await Transport.open();
  const btc = new Btc(transport);
  const result = await btc.getWalletPublicKey("44'/0'/0'/0");
  expect(result).toEqual({
    bitcoinAddress: "13KE6TffArLh4fVM6uoQzvsYq5vwetJcVM",
    chainCode:
      "bce80dd580792cd18af542790e56aa813178dc28644bb5f03dbd44c85f2d2e7a",
    publicKey:
      "0486b865b52b753d0a84d09bc20063fab5d8453ec33c215d4019a5801c9c6438b917770b2782e29a9ecc6edb67cd1f0fbf05ec4c1236884b6d686d6be3b1588abb"
  });
});

test("btc 2", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
    => e042000009000000010100000001
    <= 9000
    => e0428000254ea60aeac5252c14291d428915bd7ccd1bfc4af009f4d4dc57ae597ed0420b71010000008a
    <= 9000
    => e04280003247304402201f36a12c240dbf9e566bc04321050b1984cd6eaf6caee8f02bb0bfec08e3354b022012ee2aeadcbbfd1e92959f
    <= 9000
    => e04280003257c15c1c6debb757b798451b104665aa3010569b49014104090b15bde569386734abf2a2b99f9ca6a50656627e77de663ca7
    <= 9000
    => e04280002a325702769986cf26cc9dd7fdea0af432c8e2becc867c932e1b9dd742f2a108997c2252e2bdebffffffff
    <= 9000
    => e04280000102
    <= 9000
    => e04280002281b72e00000000001976a91472a5d75c8d2d0565b656a5232703b167d50d5a2b88ac
    <= 9000
    => e042800022a0860100000000001976a9144533f5fb9b4817f713c48f0bfe96b9f50c476c9b88ac
    <= 9000
    => e04280000400000000
    <= 32005df4c773da236484dae8f0fdba3d7e0ba1d05070d1a34fc44943e638441262a04f1001000000a086010000000000b890da969aa6f3109000
    => e04000000d03800000000000000000000000
    <= 41046666422d00f1b308fc7527198749f06fedb028b979c09f60d0348ef79c985e4138b86996b354774c434488d61c7fb20a83293ef3195d422fde9354e6cf2a74ce223137383731457244716465764c544c57424836577a6a556331454b4744517a434d41612d17bc55b7aa153ae07fba348692c2976e6889b769783d475ba7488fb547709000
    => e0440000050100000001
    <= 9000
    => e04480003b013832005df4c773da236484dae8f0fdba3d7e0ba1d05070d1a34fc44943e638441262a04f1001000000a086010000000000b890da969aa6f31019
    <= 9000
    => e04480001d76a9144533f5fb9b4817f713c48f0bfe96b9f50c476c9b88acffffffff
    <= 9000
    => e04a80002301905f0100000000001976a91472a5d75c8d2d0565b656a5232703b167d50d5a2b88ac
    <= 00009000
    => e04800001303800000000000000000000000000000000001
    <= 3145022100ff492ad0b3a634aa7751761f7e063bf6ef4148cd44ef8930164580d5ba93a17802206fac94b32e296549e2e478ce806b58d61cfacbfed35ac4ceca26ac531f92b20a019000    
    `)
  );
  const transport = await Transport.open();
  const btc = new Btc(transport);
  var tx1 = btc.splitTransaction(
    "01000000014ea60aeac5252c14291d428915bd7ccd1bfc4af009f4d4dc57ae597ed0420b71010000008a47304402201f36a12c240dbf9e566bc04321050b1984cd6eaf6caee8f02bb0bfec08e3354b022012ee2aeadcbbfd1e92959f57c15c1c6debb757b798451b104665aa3010569b49014104090b15bde569386734abf2a2b99f9ca6a50656627e77de663ca7325702769986cf26cc9dd7fdea0af432c8e2becc867c932e1b9dd742f2a108997c2252e2bdebffffffff0281b72e00000000001976a91472a5d75c8d2d0565b656a5232703b167d50d5a2b88aca0860100000000001976a9144533f5fb9b4817f713c48f0bfe96b9f50c476c9b88ac00000000"
  );
  const result = await btc.createPaymentTransactionNew(
    [[tx1, 1]],
    ["0'/0/0"],
    undefined,
    "01905f0100000000001976a91472a5d75c8d2d0565b656a5232703b167d50d5a2b88ac"
  );
  expect(result).toEqual(
    "0100000001c773da236484dae8f0fdba3d7e0ba1d05070d1a34fc44943e638441262a04f10010000006b483045022100ff492ad0b3a634aa7751761f7e063bf6ef4148cd44ef8930164580d5ba93a17802206fac94b32e296549e2e478ce806b58d61cfacbfed35ac4ceca26ac531f92b20a0121026666422d00f1b308fc7527198749f06fedb028b979c09f60d0348ef79c985e41ffffffff01905f0100000000001976a91472a5d75c8d2d0565b656a5232703b167d50d5a2b88ac00000000"
  );
});

test("btc 3", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
    => e042000009000000010100000001
    <= 9000
    => e0428000254ea60aeac5252c14291d428915bd7ccd1bfc4af009f4d4dc57ae597ed0420b71010000008a
    <= 9000
    => e04280003247304402201f36a12c240dbf9e566bc04321050b1984cd6eaf6caee8f02bb0bfec08e3354b022012ee2aeadcbbfd1e92959f
    <= 9000
    => e04280003257c15c1c6debb757b798451b104665aa3010569b49014104090b15bde569386734abf2a2b99f9ca6a50656627e77de663ca7
    <= 9000
    => e04280002a325702769986cf26cc9dd7fdea0af432c8e2becc867c932e1b9dd742f2a108997c2252e2bdebffffffff
    <= 9000
    => e04280000102
    <= 9000
    => e04280002281b72e00000000001976a91472a5d75c8d2d0565b656a5232703b167d50d5a2b88ac
    <= 9000
    => e042800022a0860100000000001976a9144533f5fb9b4817f713c48f0bfe96b9f50c476c9b88ac
    <= 9000
    => e04280000400000000
    <= 3200e4eac773da236484dae8f0fdba3d7e0ba1d05070d1a34fc44943e638441262a04f1001000000a086010000000000c79483cc9a6e96fe9000
    => e0440000050100000001
    <= 9000
    => e04480002600c773da236484dae8f0fdba3d7e0ba1d05070d1a34fc44943e638441262a04f100100000069
    <= 9000
    => e04480003252210289b4a3ad52a919abd2bdd6920d8a6879b1e788c38aa76f0440a6f32a9f1996d02103a3393b1439d1693b063482c04b
    <= 9000
    => e044800032d40142db97bdf139eedd1b51ffb7070a37eac321030b9a409a1e476b0d5d17b804fcdb81cf30f9b99c6f3ae1178206e08bc5
    <= 9000
    => e04480000900639853aeffffffff
    <= 9000
    => e04a80002301905f0100000000001976a91472a5d75c8d2d0565b656a5232703b167d50d5a2b88ac
    <= 00009000
    => e04800001303800000000000000000000000000000000001
    <= 3045022100b5b1813992282b9a1fdd957b9751d79dc21018abc6586336e272212cc89cfe84022053765a1da0bdb5a0631a9866f1fd4c583589d5188b11cfa302fc20cd2611a71e019000    
    `)
  );
  const transport = await Transport.open();
  const btc = new Btc(transport);
  var tx1 = btc.splitTransaction(
    "01000000014ea60aeac5252c14291d428915bd7ccd1bfc4af009f4d4dc57ae597ed0420b71010000008a47304402201f36a12c240dbf9e566bc04321050b1984cd6eaf6caee8f02bb0bfec08e3354b022012ee2aeadcbbfd1e92959f57c15c1c6debb757b798451b104665aa3010569b49014104090b15bde569386734abf2a2b99f9ca6a50656627e77de663ca7325702769986cf26cc9dd7fdea0af432c8e2becc867c932e1b9dd742f2a108997c2252e2bdebffffffff0281b72e00000000001976a91472a5d75c8d2d0565b656a5232703b167d50d5a2b88aca0860100000000001976a9144533f5fb9b4817f713c48f0bfe96b9f50c476c9b88ac00000000"
  );
  const result = await btc.signP2SHTransaction(
    [
      [
        tx1,
        1,
        "52210289b4a3ad52a919abd2bdd6920d8a6879b1e788c38aa76f0440a6f32a9f1996d02103a3393b1439d1693b063482c04bd40142db97bdf139eedd1b51ffb7070a37eac321030b9a409a1e476b0d5d17b804fcdb81cf30f9b99c6f3ae1178206e08bc500639853ae"
      ]
    ],
    ["0'/0/0"],
    "01905f0100000000001976a91472a5d75c8d2d0565b656a5232703b167d50d5a2b88ac"
  );

  expect(result).toEqual([
    "3045022100b5b1813992282b9a1fdd957b9751d79dc21018abc6586336e272212cc89cfe84022053765a1da0bdb5a0631a9866f1fd4c583589d5188b11cfa302fc20cd2611a71e"
  ]);
});

test("btc 4", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
    => e04e000117048000002c800000008000000000000000000474657374
    <= 00009000
    => e04e80000100
    <= 3045022100e32b32b8a6b4228155ba4d1a536d8fed9900606663fbbf4ea420ed8e944f9c18022053c97c74d2f6d8620d060584dc7886f5f3003684bb249508eb7066215172281a9000
    `)
  );
  const transport = await Transport.open();

  const btc = new Btc(transport);
  const result = await btc.signMessageNew(
    "44'/0'/0'/0",
    Buffer.from("test").toString("hex")
  );

  expect(result).toEqual({
    r: "e32b32b8a6b4228155ba4d1a536d8fed9900606663fbbf4ea420ed8e944f9c18",
    s: "53c97c74d2f6d8620d060584dc7886f5f3003684bb249508eb7066215172281a",
    v: 0
  });
});

test("btc seg multi", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
    => e040000015058000003180000001800000050000000000000000
    <= 4104f004370a593b3cde1511801a1151c86dd09a2f246a3f9ac3ef0b0240c0aeb506feddb0a785f5039c3e3e829db9692364e333256284d0fe312177cb12b88551162131764a4336523431416334685a61704a7863334c5a6e69334e7169445837514562141c248b44b74cbe35a3a92801cfebaf895df8d65f5830264097260c863fc1e59000
    => e040000015058000003180000001800000050000000000000000
    <= 4104f004370a593b3cde1511801a1151c86dd09a2f246a3f9ac3ef0b0240c0aeb506feddb0a785f5039c3e3e829db9692364e333256284d0fe312177cb12b88551162131764a4336523431416334685a61704a7863334c5a6e69334e7169445837514562141c248b44b74cbe35a3a92801cfebaf895df8d65f5830264097260c863fc1e59000
    => e0440002050100000002
    <= 9000
    => e04480022e02f5f6920fea15dda9c093b565cecbe8ba50160071d9bc8bc3474e09ab25a3367d00000000c03b47030000000000
    <= 9000
    => e044800204ffffffff
    <= 9000
    => e04480022e023b9b487a91eee1293090cc9aba5acdde99e562e55b135609a766ffec4dd1100a0000000080778e060000000000
    <= 9000
    => e044800204ffffffff
    <= 9000
    => e04a80002101ecd3e7020000000017a9142397c9bb7a3b8a08368a72b3e58c7bb85055579287
    <= 00009000
    => e0440080050100000001
    <= 9000
    => e04480802e02f5f6920fea15dda9c093b565cecbe8ba50160071d9bc8bc3474e09ab25a3367d00000000c03b47030000000019
    <= 9000
    => e04480801d76a9140a146582553b2f5537e13cef6659e82ed8f69b8f88acffffffff
    <= 9000
    => e04800001b058000003180000001800000050000000000000000000000000001
    <= 30440220081d5f82ec23759eaf93519819faa1037faabdc27277c8594f5e8e2ba04cb24502206dfff160629ef1fbae78c74d59bfa8c7d59f873c905b196cf2e3efa2273db988019000
    => e0440080050100000001
    <= 9000
    => e04480802e023b9b487a91eee1293090cc9aba5acdde99e562e55b135609a766ffec4dd1100a0000000080778e060000000019
    <= 9000
    => e04480801d76a9140a146582553b2f5537e13cef6659e82ed8f69b8f88acffffffff
    <= 9000
    => e04800001b058000003180000001800000050000000000000000000000000001
    <= 3145022100c820c90ce84c6567617733cd6409c4b8f7469b863d811a3cdc73bf3fa43912bc0220320b7fd259939a6821d371f2b49a755d1ca588bffb1476fbb2da68907427b54b019000    
    `)
  );
  const transport = await Transport.open();

  const btc = new Btc(transport);
  var tx1 = btc.splitTransaction(
    "0100000000010130992c1559a43de1457f23380fefada09124d22594bbeb46ab6e9356e8407d39010000001716001417507f91a6594df7367a0561e4d3df376a829e1fffffffff02c03b47030000000017a9142397c9bb7a3b8a08368a72b3e58c7bb850555792875f810acf0900000017a914813a2e6c7538f0d0afbdeb5db38608804f5d76ab8702483045022100e09ca8a5357623438daee5b7804e73c9209de7c645efd405f13f83420157c48402207d3e4a30f362e062e361967c7afdd45e7f21878a067b661a6635669e620f99910121035606550fd51f6b063b69dc92bd182934a34463f773222743f300d3c7fd3ae47300000000",
    true
  );
  var tx2 = btc.splitTransaction(
    "0100000000010176ef6abce7feecefbe1322da6cd21245f2d475a1836f13e99f56847bf7127f7c0100000017160014a4e29e297768fccd19cabc21cced93a6afc803eeffffffff0280778e060000000017a9142397c9bb7a3b8a08368a72b3e58c7bb8505557928795061b51b100000017a914c5cfa33e119f60c7cb40bd6b9cfe9e78b026eb6a8702473044022031f0c72683374275328ef0341ed1f233c55a37e21335f9c111c25645b50d0d4e0220670b833be0f688c237bf4466d2b94c99631ada3557c95a7d13bfbb9177125c340121020879f8616da54f8ac5476b97fbe0329c5a0e4cbd32e22e7348262bdfad99a44200000000",
    true
  );
  const result = await btc.createPaymentTransactionNew(
    [
      [tx1, 0],
      [tx2, 0]
    ],
    ["49'/1'/5'/0/0", "49'/1'/5'/0/0"],
    undefined,
    "01ecd3e7020000000017a9142397c9bb7a3b8a08368a72b3e58c7bb85055579287",
    undefined,
    undefined,
    true
  );

  expect(result).toEqual(
    "01000000000102f5f6920fea15dda9c093b565cecbe8ba50160071d9bc8bc3474e09ab25a3367d00000000171600140a146582553b2f5537e13cef6659e82ed8f69b8fffffffff3b9b487a91eee1293090cc9aba5acdde99e562e55b135609a766ffec4dd1100a00000000171600140a146582553b2f5537e13cef6659e82ed8f69b8fffffffff01ecd3e7020000000017a9142397c9bb7a3b8a08368a72b3e58c7bb85055579287024730440220081d5f82ec23759eaf93519819faa1037faabdc27277c8594f5e8e2ba04cb24502206dfff160629ef1fbae78c74d59bfa8c7d59f873c905b196cf2e3efa2273db988012102f004370a593b3cde1511801a1151c86dd09a2f246a3f9ac3ef0b0240c0aeb50602483045022100c820c90ce84c6567617733cd6409c4b8f7469b863d811a3cdc73bf3fa43912bc0220320b7fd259939a6821d371f2b49a755d1ca588bffb1476fbb2da68907427b54b012102f004370a593b3cde1511801a1151c86dd09a2f246a3f9ac3ef0b0240c0aeb50600000000"
  );
});

test("btc sign p2sh seg", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
    => e0440002050100000001
    <= 9000
    => e04480022e021ba3852a59cded8d2760434fa75af58a617b21e4fbe1cf9c826ea2f14f80927d00000000102700000000000000
    <= 9000
    => e044800204ffffffff
    <= 9000
    => e04a8000230188130000000000001976a9140ae1441568d0d293764a347b191025c51556cecd88ac
    <= 00009000
    => e0440080050100000001
    <= 9000
    => e04480802e021ba3852a59cded8d2760434fa75af58a617b21e4fbe1cf9c826ea2f14f80927d00000000102700000000000047
    <= 9000
    => e0448080325121026666422d00f1b308fc7527198749f06fedb028b979c09f60d0348ef79c985e41210384257cf895f1ca492bbee5d748
    <= 9000
    => e0448080195ae0ef479036fdf59e15b92e37970a98d6fe7552aeffffffff
    <= 9000
    => e04800001303800000000000000000000000000000000001
    <= 3045022100932934ee326c19c81b72fb03cec0fb79ff980a8076639f77c7edec35bd59da1e02205e4030e8e0fd2405f6db2fe044c49d3f191adbdc0e05ec7ed4dcc4c6fe7310e5019000    
    `)
  );
  const transport = await Transport.open();

  const btc = new Btc(transport);

  var tx1 = btc.splitTransaction(
    "0100000001d3a05cd6e15582f40e68bb8b1559dc9e5b3e4f9f34d92c1217dc8c3355bc844e010000008a47304402207ab1a4768cbb036d4bce3c4a294c13cc5ae6076fc7bedce88c62aa80ae366da702204f8fea6923f8df36315c0c26cb42d8d7ab52ca4736776816e10d6ce51906d0600141044289801366bcee6172b771cf5a7f13aaecd237a0b9a1ff9d769cabc2e6b70a34cec320a0565fb7caf11b1ca2f445f9b7b012dda5718b3cface369ee3a034ded6ffffffff02102700000000000017a9141188cc3c265fbc01a025fc8adec9823effd0cef187185f9265170100001976a9140ae1441568d0d293764a347b191025c51556cecd88ac00000000",
    true
  );

  const result = await btc.signP2SHTransaction(
    [
      [
        tx1,
        0,
        "5121026666422d00f1b308fc7527198749f06fedb028b979c09f60d0348ef79c985e41210384257cf895f1ca492bbee5d7485ae0ef479036fdf59e15b92e37970a98d6fe7552ae"
      ]
    ],
    ["0'/0/0"],
    "0188130000000000001976a9140ae1441568d0d293764a347b191025c51556cecd88ac",
    undefined,
    undefined,
    true
  );

  expect(result).toEqual([
    "3045022100932934ee326c19c81b72fb03cec0fb79ff980a8076639f77c7edec35bd59da1e02205e4030e8e0fd2405f6db2fe044c49d3f191adbdc0e05ec7ed4dcc4c6fe7310e501"
  ]);
});

test("signMessage", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
    => e04e00011d058000002c800000008000000000000000000000000006666f6f626172
    <= 00009000
    => e04e80000100
    <= 314402205eac720be544d3959a760d9bfd6a0e7c86d128fd1030038f06d85822608804e20220385d83273c9d03c469596292fb354b07d193034f83c2633a4c1f057838e12a5b9000
    `)
  );

  const transport = await Transport.open();

  const btc = new Btc(transport);

  const res = await btc.signMessageNew(
    "44'/0'/0'/0/0",
    Buffer.from("foobar").toString("hex")
  );

  expect(res).toEqual({
    v: 1,
    r: "5eac720be544d3959a760d9bfd6a0e7c86d128fd1030038f06d85822608804e2",
    s: "385d83273c9d03c469596292fb354b07d193034f83c2633a4c1f057838e12a5b"
  });
});

test("signLiquidDirect", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
      => e040000015058000002c800006f0800000000000000000000004
      <= 4104bff933ba22e896a0cc0a0834f11c6afb63995605d4def392776a26535cea8e9b4703133bd7dfeb712b3f64196b4306eb5af8fc19bc1701960c43f1295ade67b022507a77614d4271727332556337314e56585548505275704e4a6f53624a5053706b34eab942576f0c24b0125dbcd96e5cd0484a2f111a5634c4e1683b621c88d6f5c99000
      => e0440006050200000001
      <= 9000
      => e04480064703e46aa5d11fb7f2243e75bbd90ad94e5ae0d1992c4a5c0d6ba71a77e73df8e23b000000000869291ddd2ff53c38c1086a229d1ddc6a486a92cf3ad3fd42d32c90623df1c9fd00
      <= 9000
      => e044800604ffffffff
      <= 9000
      => e0e003006c6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d0000000000032e740000000131076c1e76449e0c39b51ef4506aa25983985c7379e825a4bc51cfdfc4ac74c9ad0db665af8c82e318c88db21846118ca69f98ec863284496c37b8e901454c68
      <= ad0db665af8c82e318c88db21846118ca69f98ec863284496c37b8e901454c6831076c1e76449e0c39b51ef4506aa25983985c7379e825a4bc51cfdfc4ac74c980000000010b547995d08f8fa9e87e122548afc2ea80f552aee8e45a44df4cb81292fed26530086bd721b7048f58fc925f56b0642e107a492c9509b475186f7fd573e47a5004376f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d0000000000032e748af3a811037f28687fcb65f29273471a87cb89849221bbdbe5f6137d4efddfdf9000
      => e04a00000102
      <= 009000
      => e04a00002a016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f0100000000000005dc
      <= 009000
      => e04a00000100
      <= 009000
      => e04a00000100
      <= 009000
      => e04a00000100
      <= 009000
      => e04a00008f80000000010b547995d08f8fa9e87e122548afc2ea80f552aee8e45a44df4cb81292fed26530086bd721b7048f58fc925f56b0642e107a492c9509b475186f7fd573e47a5004376f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d0000000000032e748af3a811037f28687fcb65f29273471a87cb89849221bbdbe5f6137d4efddfdf
      <= 009000
      => e04a000021020129d9733769531b80adf2a6ab2f8e212beb26f94ebc2afdb43d5b04cac794b4
      <= 009000
      => e04a00002102a6a029194366caecead01565df27d779e7ac405de3b38572fd9091080f03d77e
      <= 009000
      => e04a80001a1976a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac
      <= 9000
      => e0e680000100
      <= 9000
      => e0440080050200000001
      <= 9000
      => e04480804703e46aa5d11fb7f2243e75bbd90ad94e5ae0d1992c4a5c0d6ba71a77e73df8e23b000000000869291ddd2ff53c38c1086a229d1ddc6a486a92cf3ad3fd42d32c90623df1c9fd19
      <= 9000
      => e04480801d76a9142851f8219e77b0f3ae8421a8274168c743e574d288acffffffff
      <= 9000
      => e048000061058000002c800006f080000000000000000000000446304402205ff18227381e9ecc05cf5d8a5d49166da3b639abf9c114b56c9b7a14870bd0270220371015a2a816e2cf1c992207a65fbed9e164bab476277e0eb929f16ecda7e49e0000000001
      <= 3045022100917ccdbe993dbc4c0bfe0839bf7df16eb481a175c60a7badbb676145e75f924a022012a868a2286420a3d0793e241c4f767a95c985db7c44a0c8a0e872843fc230c8019000
    `)
  );
  const transport = await Transport.open();  
  const btc = new Btc(transport);
  var tx1 = btc.splitTransaction(
     "020000000102cff2da20f8e5b8509efa330427576c537c68e9857b043a0025613772e7755cc1000000006b48304502210080b44399b81a1da40a2e558f2316b99b8780fb0d53fdba00fdd09f9b5ea0991e022050e659c7c29376577b58dddca67b6734e4c2130c7cdbdd39d75d9930ae89f635012103b3b0e8813505e43b8458fc36cf18a2ec03df5bfa4b0b2c0f4fd87155c9350ddefeffffff26cfc77b1c2e223f874431efc0c2609c860e70b4eedde2a377db2ef796814179010000006b483045022100a2a643d901117a0179426398d1fa4b7a140b0204afd45c5ffc7a2513f93b4de0022013529c986890cc781ad7bc9f1760ba389a6af0bfd8a1819c046c6ed9fe03e1db012103358a087d1e6c618254a46254ebaca75cb239179ccedc118151ab919179b33f59feffffff030ad0be2e9f3f6d8e57aaf95d73063ff2b9a3d4a43e34702f7f9407466ef073e9760869291ddd2ff53c38c1086a229d1ddc6a486a92cf3ad3fd42d32c90623df1c9fd029615199ad0cd0c4da1ef7485616077bdaf42c802b891976d215da8d87353659317a9143d0bc0a47bb048ee9f8e2f265658a5ac845dabc5870a741e7c88fc62c426964ab5937ee2cd105770fdab69cc7d80582adc5ebb4dea3c083e5cd457ffae83fff38b18c1f3560aa8eaf8b109d527323b8df53f052cdb0f0203e65ef1d60771ee222bbf3aad70b72de46a2fafdc4c6fb3f0fa049fe77ed42ee01976a9143c6dec016103bef153931464b03a790e0848b26b88ac016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f01000000000000083400009c950600000000000000000063020003b3df8acac19653da7f6270429447d7e1b38e6c2d0b92b4d578e67fa507ed1db5283779e7b2f59d04be3e05f2743a28528bb9a89a244f122feba497ef412f58ca8c24e960c10eb18ef29d70763894fc471db1667e409835a8f3f01f49f644aba7fd4d0b602300000000000000015232005c9693e00f296a4aae19ce6501e236a65b0135f2907bd3736cf471e18fe306e795e8aafed6a6bc75af6a8042b246dda6ce0df5196f3f964f9eb47a5c6da32be5b9b9e974b103918d4279c877b98c1e9b7ff1b54e88155f87cd2a2258b1a6deb1121fa3c725cded84d06b1ca937cec69a64358242da95db127297641a781ddb5f69aced06489195d99baaf17e1d3e59a52b3e8680347e47e6584744065a80e3619905ff36215aab44f6179bade9020cc460ef93362f64d712069cd6b5208c41a4c1d839078254d7eb5f6b4850135d0ff2586e4060980b0705c96644e731613dc42341ed1fdf0c69b4615fdc9703a4804971404dc245478b8ae235aa5da880e06e06fa69f7b479f72eec63e11fb883672d12ba1141b9cea488179afe0ff0a3f9a6cbb41ca28da27cfd3ef1b3807e184c54aa3a836ec9dfddf3b4226536bd03abe766ea62ba5d4f26b5e6ee9967016ac98e288194b89fa9dc4b352d454166d294e5b6a4fe16d2a309862043aa3d01bb2caa6f309902e12ffbb0dd2767e31e1af56ac75cace803c7ecaae3f3ef2b32808faf6df1fbcb7dffd097146512ed727c73a1f19b9cacee7e5f6b6c548a6a35e68ca59c1e10cdc06e2bc26c474bc9e93af32b9242bf1a2b1e43ee39f427500e70cdb84c1b0a41671dad3b8b314c65fe04a363a8d79acb4d28a052048450c807770dbd801a1d358f2daf1cacc5861946b3126edfc62fc8071f473ebaaf530fc52a052d1f2ba7d70df46762ac50828257c24f89c8a83164432cc65aa75c547423eb6a55501a4d8527dddf9312463b9f92e27ca9d6b979bc3ff87f9599ab7a343874cc75d4ffbb2a34f11779ff642d01f7060ae4682b29e86d144fde32ea1135bb9480df7e77fda452abd9d11152ea321755de5fe9617ec4482dd18a136ca93209e076025a90b663dc28e057be8ae2a571d68e539c29d0d5319d0ef4d57128a48a0e1a32151886d2664ed822b7711bf17a60346cb3f1ef714ce9ac2f39b8210889af367378731e0d19ddac44a8733c7b3d49c0e6c5ba8003daab81af79000e67bdf2d261ebdd7ae02e3c4059021af0a3d9be5be5a2f29f917495380b121aeeed3236a5bd98e83b8e155632b08809e8779159858d9f60c1cc93d76456715094106c833b675938890af4c6c8aa26786d58407972e16fef9131f7c3bee41a252c3023beb29c55f4b57fca7f56f25626c9b668797653dfea81d9473934f5291b9dda6e2228f2b67bc57014300991349d5baa91f500e0b6bb384954c243e8300ac73213890782e410124e477d0389f6b85cd3c4e1549b584aa9daff51aa5915f9d588ee40607a7016dcbd60552d6e980a5892223feb33c07176a51c28a3b242b0f5e10f8cfb5ce2fadade497ea46d3ff8babd385772e89f7bdbfe55713e73d8f690d766a988e60254c205553f30bbd1f8903935bffb4e1fad616939989739f5c44919977d74b4fe44a127ce53c0782378bf1a4420e901b998994a65787e206357b1241e33d4c4d5cf23d9913e80b161e9de8fbda9040b7f87e306582ea81abd3fdff0e93dad926b49da4bf390441abf0f48a333ca2197f0b74127bbad8a3712cab0a4458b011e2fd559f5b42efe51d3ffd5eaa8c69e861a7d4aff589b8b3414e297607adf5b296eba6726bfe60f0b09e16ba751c04eae302ce589bb2e70b7dacc9ecab4f88f06997d33d9e07baebf2e95ca9d971b47b2e0a9c36b4ef60c1e4b0cac1187a9474c615b5daec2463949bf940de549c17cc6d6542dfebfced4ddc05e146179cdc120a7e6aafe5426baf89579c369e2c3f6fef1c4fb5542ab38b491e6b975a0ff69eed469022fc38e9dfeaa09b3d60600c5d3b25d699c19a0eb879cae5db07a70b54db47335052b44d14716358ac6c12b940351e063a265b6fb837a945fc132f33619d4f7fe0ad6e33db25cec1866e67d622b71c8019cc1f55c4b104761bf44a630bb2217dfc118b1d41fd7dd5f9c045636b6ba5a14d47e32acb977210f1e3783b3505bdf7949b7f65e82ba659bc4002013f8d9674835b57903b773ccb3a0f7b34c1bf5de9b9871c50197e4c574658ebf56b1990cf8f00c96b9a1c671af11081672bac4ac4623b23af10cd22a1da6d1c3dce8576cbd8bb65c27629219b12ee678184702e597966714d60189202ce5f475a435ea2124f3644ef34a62da00d5156f10d7828cf4038154aa218b77bf44317e53c6ce5ec62e8564362255d587bfb2c722a30e45ace4b0f9cd98b55c0174441bff656755d9e178a87daeb95424842074b6aa2f01edd8e0c8e678b92e996481392ea6186b709bacb514f5c2477ee36730b5270e3cd5e19455b6e3c5f38f4d74af42205c2fa725bc7a5cda1439614bd5bc945e8648f8e5c332207d8ac4af3b0eb89fce295d84e1a0301187ad1b1c588367b15f8be1fa0cb03b4c885b0ac93bdd774951f4b406973076edcacb22b7588153493807c82bb8be769b62d4becdb4df088021cf9b162c73e1feb12c33f66d3ff8022f56a8d49a261ca09dc364ca20d0c15d43f45decc5efe0b56c544a25e5af0d1ba66642639d5cc4f3f5eb4839a682c71027e58e4cc4c001c399608ccfa66a911213ad8f892d71539c58ba26a21f48812a13422e3e17f7bd16f0635148fd7ec8a94a7cbc5c18d930e001ed72ef4b3dfaec31e145eb47027ddac49399204ebd05cdf35b46fa436ccf761d92685b7a63bb13cc22fa595800b9b4d3ee52bfeabc83b5b1b59d7afe74546869947069e9848741fe25d65c1d98ff3594e9dbcf3f90c83b814a801069edb4006a2af8e1f261ca01b8c7b47564fd3e55421022611859c30c3b4933c2b37e8f52e961e949339d7af2b8bb98d8f7f9b606d94580b413628316a65cdebec5bb43e3141bdd8113bb02cb93ba35bdf67320e978d29ed43960a9cd587856085540072e0e6ccf3bd408a61f4ccf06c02975cdcc519fa5b093767875516a5fcb3842cab286a3c340d410c2d554f745469262829976c20c73a39b6aa02e0189cfdd9afda2147d09c93b07132dfc24e93cf5fc379f0011f0c142fc6f99897ab8949cfaf2e97496090d797bbf61ac09ae8ae208a4f97ebd1bc2bbd775888cd49c5a0a1c1fe07eae643f1c2f1a12a4fbaee97847f649a5cc32474a3013bb933a51813a1cb3880c1672e0c6bee975f76182fb86f480da857745f7008898161db1ffc6156fba7ca920fc783f7c349543903ba7f1bbb72d03426097a081fce5f2c1c3bc34f9d838e94e91e3d5ccacdfbc577fbcb2d85510efaf0a71b9ef34c22d51a8b213abe53bcd28c863b25652df2924cdb57dc1b3469c5161a7392b2b454ba5f459865f8c6df81036a37fde81bc89e92c81ccb104238492e31aa7c879df4dd01dcd9b6361beab40ad7cc4511be85de2ea19b480b6b2bcdd5553460c02a6cea6eb3610f4cf18aa023759cbc826da0f63ceed6af824537f2fa5ff6e3655484e221972169be45505e1ae8b33d59258abc20ddb98718d2c9a68a6a91bb2056df0103e667fad06af5761cc416d6aecd88a4bc51db7ede859988cd4acfc47454a18ebb9f7a6dfa2319ac89ec19a7469f3512b22f37e5d178e3b5f2351ab3b293ac270aea08108a8f57f0745af87f4f092c7bd713f2e290b1201532bf82c10652d06a748ba83035af331bd1d077fc9f98f7a485efca4b2607ee6c0e39d5722ec2f321482bfe43b77d58acaf21ffc9ad7832b8a9f6649e2bc37a76e5ab3cc8911a541665bf9b8d9ca53c3ad4336319f8100ad21f174fbbc05af82c0e277d29a5155ddbeebb6ec5d0a06a45dbb13bb802744281d08c606e875efe3ddb3b60d5d1039d185e6b6c4851201fc78dd1b6043f97b7e7c93833900751e8493f7df5736099a1dc650595e68de5fb3c49c2227f88604279c8a28091103240897bb1dcbe56a6f5db94ec03e5ae49455c3d2523e5da7f9311b05ef0c7f199c75ea929262aebfba83ff78d8f402ca70aedfb8011f86aa009b1ef32597369babdcfbfd0a4a52acc8f791ecb402eaad0de88650cbc7584bdc4707e6df574e0972c5552a7fd763078a01f5c8983e5b872b9241c0f87a5ed9fed063020003a15a0ec496fc0b15f1cbf48f78818bb032be8d83eaa394f3e7826bcbc2adf30b9079deb2749f8fc82bcbf490b8dd06528c3b4c0e84db24ef1cec7920d7f1d8dfb9fc3ca4b6745c8e8d8616138c9ea501e1aa07412b3a84c7ee6e24f1ec83f477fd4d0b60230000000000000001acaf00371aed1fe5cb818b3cc166ee9cf159cce9b0457a3f1c657488d13e4c643bbf51856f533840607f0a98c1dbe3a4c2afdb6435ef3b8e19f772b281c891b2f9827b65e6159455a35e12c928d0c4a0699c4fc8e9436b51a2806530e4e49dce8f4cb431f7b183c0f6b6f47956c92391ce00264d357369b49ddac557915bd05622003bc5354cb49b25d7eac47caefaac6ceb72291e11e58dac2fc5c4cdad3d9da208301a5bcbdb11f3681fba60ba889a06d357ea800003aa9c143bd14135df18a52a1254e9b98f7b2bc4a2b9c45e47d8a9dcefd2404a9d1302b54ff5b0501b362d75c5d6b8d261ed28add327db80c8dca2585ff6d83f834ae8795e4e4beb2b2d0c8e116f1cab40e3de97661d897c4c652c30d996e1d32f4b5b1d82f701457b3d508c328d2552343ff83488f12ab6729b1ff1b32488e84c7d901d5fe889e1e2039a9ff140549ef85240901aeeb0f422ddc5b5331fe53cfe08e5d537f01f6e2b3f7db4d3dccc2ab21bec23bb586651cda654d68edc8ea24d6536f4f3d632b8600fd91187dfbf1a63260e906ac39889d476f589be02255a9f2bec1dd4e2d568322cbcdc79bfa456cc475b5580a07e35fe18ff2cfbdaa2d58676c56ac6597b0b2b66f3f4fa9f52ed389ceafd63a4683ba6a4ddb23c08785374945e2d30b49759f8c7062c8bbfec33c7a537041ef38fa99d10951278132af5cd192ac998edd18833eb2e93b52d71ebb05581643003a13da708b5519c271cad4d6dfffe5db3e9abe7d0e5c1302bc3058153481ca95625551b0057875455790254724b9024c42a750c44187cdd6f55bbcbda29f08d958023c88da85c3460861cd0a9d11d35d82641c03b039695c96969b392ac0e6a05b52bd8393c71cf98dd4f9ad8b77580e3bae5bf563130b94262a338a11973ec3601f51544a2e784bd56f8de73fcca9039d7b31b416662b2b8438f9e4a6db6de9f31ea1deda75115c4b30460b1f0251d7158cda9729e6b0a91f99ffcf6fb4624facbcea53ae6987dbb9c4a56a36378b23ac8f5f14745919f362493650ed543a431f8a88a54a72a259e085b3da23be49583bbe8d6255dac2addfeace86eac576fba9e72220b5f03ecb1094019d0de34bbc19c17e46a4ac38e2f65ba0662a414a3e6bad9ec19a356c916afb3130dbf78d0e2496c14223f6893325163c335cd43bc472b705de4360aabcc4a2ba3b24450e1f680362820b1ece3c4f22a586fceb070757569cceb972c8cc0ec70e5f1971ebab8fd3c0399d7244e3bb2d9b4bd9678eb0a63231ad8134b979bacc77a462b9e7b7dd5b77e0005c74ead2d8d56501c6bf08849826cb9fcce61686278c7260f0705408dbe0c79a345ef43312496aa330826a8aee71f30fa71c66c75d834ae04f2bad2cdac86f2fe150bc3ea63a93da12f3021cace8976e4135f632816967d9bc7e3f86f363747a4f87aeeedd38318c127f39480f557370860fb7a855ca8b0ad202da421a18519d95bf7b77f02da0e701871050985bed39fe197219a25665664260d236c9058a08c2c6b6f0bd781fef9f41dae1bdb9d52852e3104915f30507b92b1ae10e2a1366dd0adb30e0cede8b428f799161a2c65426bd268b35f1461be5494f97e075e7cba9644d54c593d96f88f691e041dd6100ea9e5156d570f214905417a94ee5b8dd0ebfcf2e3a9812abafe65fe41f283928bd0f01ce196d606bd8621e213a654ef67f304672659027af33a060ea658f6993caf5a8291480035baa934e3f2be9257fd6ff82f9511bd8ea60eb01a62d9eb2aabaaf0ee8c37371ebacf51633ed162fbbabd9e3533a8dbe98eca08aeb613e27b8c0c415475aa4af6ccf2f5866eae51efe4994d2d36a40bd0c193c30a532cf84e671b6ece1caafba51051b15b74a73c3a083620a1465535f42565bd7478bb1966b40f03989047e03be7f21069a80290cc8001baa2e700f22563d3fdb6b5a1bf9b7db28c27b8b37d333aa6c71746fb050dbfe5eccccf85a0177ac6118c9b2dbcc37a91e71ff408f0e60d4f87edb5a79821d156baabc845ba47196ed142ee81771c73f3a0733ad5a6c8192587cbf857d59e2269dd9ccd3fde696506ac519f6e22379f0393029a9f84f321ca253526ddb07e5a8f700c8e508cdb5267473d55b1779983b86ad9eec2c53d1adddeee1ea41409bf40b778abd9aeee69a7a06480eb8a4019d012c834bfd10c63cdc216b39515cee0732c56cd8b1ea5cfae9453551479f1ee15675ddafd1ae3539ea4b768b725be5a9cc5bfdd328f16e21934a8cceb54dd1be38787373cee191e950af1b9e17739f8a665feece8f6bab6d71886c3c0de47a07dda275418b6f1f31932a8f8dc945f56937c55d7fab12de4dc8919b2fdf089fe07d09a205886ed90d8e731330e1de82ae2105ed513e0404a28069083b0e9d3fd0c36edd4a3dbe3315ed077723d15cc0a93c08b2075a6e16ec9379465934de1de7e89866b64117873b704451e25d192a4abe58caf0a18265e17f5c34a61b188514791728b008fd22825a0bde165acdccae8062947cdb4017aaa783aad117832281d22a14696326355c2d182b99c0fab44c10db26e22dc9f9d615dbae47397f16434c4018c0a44973db8ab67624795de3cb218ffd0f0f9e5f927868ff9ce37398e7b4a80986c931b7e7e9897373df172a701072a0058808193b64feecdae4ef3f79e705739d7c400df94f84afb41f26c4dcb9a1cf9778661f51cd8cbe0cd4ff931804fa580c476b5bdfdcab9f1b7aae78634aa302eb0054a3be7034e4b68bfbdc15986261f21b361bdc96918cfbfbd884493df88fe92fa0eb17a96f6d7dbd0ec8a708038c4cac051e547ba806f57f25f82400b541bb168c060e8a37922dd668bed269d028981039a915003f77d1a30c4f9f1e14c44b1fc5737a827bdc038734b940939dedd409415271363d43402b514e2383ae120b0e7fc28a400cc967c129eb0baff7fce2d8a3f1761a69fea04e9c46dddc84c68dcf60b58563eeb99f694a1735ebdb9cba35f70f482831f182dc13d122a52cf4ef686ddaa3d6fa34452c6d103e07a9ddc0d9b765711e4a1f067b2ed12870d2b811da197b9e645ed1ee22f992ca79aa2bfa3230fb09ede60b42b900f821c4294f6e408572a96936a0996e8f49a55454c4b5317dcffe11d588e9fa24038e0dc7e52e274ff9535ab7e585fd9dae7b3bcac5aac1e481f9b9d64c14a33133e4b03c7ee91e206011037fd196853e9ff9986f73cbdd1d817a13a0485f0dbc94d7983bd92865d19cd08e6629f2993b08ce478482fc7a8219890eb56bfd088ded3113891c3ff39b831f447d4a061fcd79f4c064e543987450dcdf8dac7adca424618775a8f0718c497dc7165dacba2fd3e6a1ef82f60d31f196b7efb665001a8fd168e81e6a12a6e10bb52cc66c777f878318e809f85ef0fb353fd80ac1000f3ae55816ab958e88f0e6b2d020cacf8fc20e81c1bf38d382362e4de31c366d1ab5fe467d8503151a976fadd45323d81afe753a67847d9e5e53c265cd291c393270e30d1c89115194b77f1ced483f402667adc7424b5d83e64b7c1837282b658f017c87f6ec4ec60c4b4dc2e2fe809aded5d8460d54d0922c74edd7e4e3c92eb7eda8800808afefa54d27721db30b93dd6159fbff0face0741f6594ab7b0dea1952426a940830dc8ac92b90a7f632c00a584923d866d27ea1f764174c986518718856013328bbc5e97ff32a0c8182ef1d27747a420d5e11beb45d3f3bcb43463cbae8289a2c61c566bc0e9f9e2043e3ae773d0d07b7d7f05554f55ee41f554684c607d9d3e1bd597b6e02d8cb16feb4991df514f80ea445e74343dae0a709a9d872d6f865aada311fd8b251b1213338c45b68e8b218f97230da88ec03d1be63184c9fde0682d441b93786693becb319d35cb3a28690502812b770c93f0ce94ca42136abd3ad32d97ccfef7419b670ee21d0c0a5abe431a256e23bcc2293e58c7f84099327e4662c134468258f685ffc860ef67d725e2b651852f58aa4dad172121cff6ab5b3fe69fe868411147f10095c9db37843eaaa00ae5dc64c387cb2c9e975c190a0000",
     false, false, false,
     ["liquid"]
  );
  const result = await btc.signLiquidTransaction(
    [
      [tx1, 0, undefined, undefined, undefined, undefined, undefined, "304402205ff18227381e9ecc05cf5d8a5d49166da3b639abf9c114b56c9b7a14870bd0270220371015a2a816e2cf1c992207a65fbed9e164bab476277e0eb929f16ecda7e49e" ],
    ],
    ["44'/1776'/0'/0/4"],
    undefined,
    [
      [ "00000000000005dc", 
        "6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d", 
        "",
        "00",
        "00",
        "0000000000000000000000000000000000000000000000000000000000000000",
        undefined,
        "0000000000000000000000000000000000000000000000000000000000000000",
        undefined
      ],
      [ "0000000000032e74", 
        "6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d", 
        "76a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac",
        "02a6a029194366caecead01565df27d779e7ac405de3b38572fd9091080f03d77e",
        "020129d9733769531b80adf2a6ab2f8e212beb26f94ebc2afdb43d5b04cac794b4",
        "ad0db665af8c82e318c88db21846118ca69f98ec863284496c37b8e901454c68",
        undefined,
        "31076c1e76449e0c39b51ef4506aa25983985c7379e825a4bc51cfdfc4ac74c9",
        undefined
      ]
    ]
  );
  expect(result).toEqual(["3045022100917ccdbe993dbc4c0bfe0839bf7df16eb481a175c60a7badbb676145e75f924a022012a868a2286420a3d0793e241c4f767a95c985db7c44a0c8a0e872843fc230c801"]);
});

test("signLiquidMultiInputDirect", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
      => e040000015058000002c800006f0800000000000000000000002
      <= 4104fb4ed3d3d49dc785460cca727432abaa464f206f95facb5dadb370d94ecc03140d748414c7228a7c009e74b8eefebf3cd78ef5f9f00b8372fda47cd189cb817d22507a563551567555735259797970794e756a65536546466b78784666397a6d33776da0e6a0e11e5698ab8fdf6c8576dd38f86d17a92e20b2331950b366cdf8deb6219000
      => e040000015058000002c800006f0800000000000000000000003
      <= 41042697b4808b8b0e9a3f470aacef2d1f8a3b13f8ce945c673676e9d08d77134d18757b8311b5cc28f79da2f1079a24613b34a957002bcd78e1d39a072032d73ffe2251317258797254783631365052636b79367864436a473979487043777347755a4e58f79cbd0c780902f16821c38227131671107b9b16146440505885add852c630329000
      => e0440006050200000002
      <= 9000
      => e044800647032ab9bd605f57c6d127e79c5a270a16cbadc5a5935d5f4c25e4521e4612f3f41a00000000099df9a89250c159b992b3d92406dad796f33b6b9bac4af40e3d5f81e8146b896d00
      <= 9000
      => e044800604ffffffff
      <= 9000
      => e0448006470364b00ada3f4d0637d30f0fc8d649b93f1c684dc551b46b0888204909ce90eeec010000000877ace637548abaf714790ce8ea2509589e0ed58534b142393b9d1c29da9b30c100
      <= 9000
      => e044800604ffffffff
      <= 9000
      => e0e003006c6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d0000000000063bb4000000011b691220c65075921aaba609c6b1d4edda22db228aa129e142f8720e741087e591ff512ea0bef8f0d075a5a47c82e6d46e845e49e5e7bd2348c9b0c6afdb10f7
      <= 91ff512ea0bef8f0d075a5a47c82e6d46e845e49e5e7bd2348c9b0c6afdb10f71b691220c65075921aaba609c6b1d4edda22db228aa129e142f8720e741087e580000000010b4bb983d4c2e11085646372b752159266eaaeb96ad5650526b8652804fb548d0608d04939274d5c21f73f1757b2ccd8e277bb8173b78acb838fd244e25be0eff6f66f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d0000000000063bb495b18b7505cca4a876345d29b0869e6d2ee325aa8a02e9d61055c4d5d4956afc9000
      => e04a00000102
      <= 009000
      => e04a00002a016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f0100000000000005dc
      <= 009000
      => e04a00000100
      <= 009000
      => e04a00000100
      <= 009000
      => e04a00000100
      <= 009000
      => e04a00008f80000000010b4bb983d4c2e11085646372b752159266eaaeb96ad5650526b8652804fb548d0608d04939274d5c21f73f1757b2ccd8e277bb8173b78acb838fd244e25be0eff6f66f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d0000000000063bb495b18b7505cca4a876345d29b0869e6d2ee325aa8a02e9d61055c4d5d4956afc
      <= 009000
      => e04a000021020129d9733769531b80adf2a6ab2f8e212beb26f94ebc2afdb43d5b04cac794b4
      <= 009000
      => e04a00002102a6a029194366caecead01565df27d779e7ac405de3b38572fd9091080f03d77e
      <= 009000
      => e04a80001a1976a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac
      <= 9000
      => e0e68000020000
      <= 9000
      => e0440080050200000001
      <= 9000
      => e044808047032ab9bd605f57c6d127e79c5a270a16cbadc5a5935d5f4c25e4521e4612f3f41a00000000099df9a89250c159b992b3d92406dad796f33b6b9bac4af40e3d5f81e8146b896d19
      <= 9000
      => e04480801d76a914234efe7282c806be2499558e261bbe8dc4ea2a3d88acffffffff
      <= 9000
      => e048000062058000002c800006f08000000000000000000000024730450221008b5256dbde6b6e36d1c35abb756089ea6f5a30269ed9ed921506e0070e7dfb6e0220581edefe0ba8fce11441e97d4b212664c49166265cccf35d55e8a04e4ccee85d0000000001
      <= 3045022100d0d15a77e16f171c51a445c417ecd9e0ccd82bbd825b06b83cc44bdff763b832022025b5d2242f59bc8a10a3233999036e4e633797ee8f316922626db5d2560e689e019000
      => e0440080050200000001
      <= 9000
      => e0448080470364b00ada3f4d0637d30f0fc8d649b93f1c684dc551b46b0888204909ce90eeec010000000877ace637548abaf714790ce8ea2509589e0ed58534b142393b9d1c29da9b30c119
      <= 9000
      => e04480801d76a914325609e680f59b40b41c010278f64afc6160c5f288acffffffff
      <= 9000
      => e048000062058000002c800006f08000000000000000000000034730450221008b5256dbde6b6e36d1c35abb756089ea6f5a30269ed9ed921506e0070e7dfb6e0220581edefe0ba8fce11441e97d4b212664c49166265cccf35d55e8a04e4ccee85d0000000001
      <= 3145022100a1aa5a026ba5fc51f167114e4df2c7574cb9c6542ca2cc45191de2a7a173d1d402203a59439ee34d3a4230488666a31e4750facff5d88a1c0888d25784711e9b65d7019000    
    `)
  );
  const transport = await Transport.open();  
  const btc = new Btc(transport);
  var tx1 = btc.splitTransaction(
     "0200000001022f3764e4255dc3bae55f650fbf0b634060991f03d95c9958d450dced4494444f000000006a473044022071a37559ffa88ff0ac15c25b3ae29ae4990907ba28288350e2102aad8d40e19b02202abd79663f3058a4de1cf77ae7c3054aea28edfde178c8a036a8e97c2a20db990121024479ec2db9a63c9379cf363507f8956d827ca7f628244349395979a83da2f6d5feffffff1ae62e41fe96d14b65b534268a2c8b53890e497d79759b4c787878473e2dc098000000006a47304402203da7176596f5fa88d518d829800e5f7c4c3539d1072c0246763f142c95fca81b0220708f08f5d1ac15fba6d9e7c4d945daadc92d5161a4a323bf99593ae502050134012103b3b0e8813505e43b8458fc36cf18a2ec03df5bfa4b0b2c0f4fd87155c9350ddefeffffff030b445fcb0484be5ed2bc27d7e66062bdc0f279ca916929b633c69a06fa72cd960d099df9a89250c159b992b3d92406dad796f33b6b9bac4af40e3d5f81e8146b896d0295c4e1502a48df7bb7a78c41ec6a3f3691259cb1bbc790410e922bbdf2ae662e17a914d8761925d29ebf5cf8ea77341c4ca5c2ff93e1e3870a44030233399c3aadbdfa29d746eb23302787239f8f8a9ecc23c62b66fe133c67088616b9c6938992fada5548d92aa63b5ddc62a15af41c2722b110adf211e1b84002e5e054c67a37cb6dc30d0c2384689e00961938f9ba81a5f94f2d9f2905d155411976a914ecd706264be249fea4bf03b032ea6a89eb5e6dde88ac016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f0100000000000008340000bf91060000000000000000006302000367306dac74c4bc418dd784941cedba9175c2de217528057f5ccb84352d8de96924e855fe9e463f15b93299237bfde0a573363a11ae503fd3b06c07a633a08b53658c860b1d9a5f8694392e8af9578301994b31b63fece76329823f12a11dbda7fd4d0b60230000000000000001870d01ec1a434c683e7ed1bdd15708e66750e896ae3cda24ff005c409b7ff3a7d42e680a0b00f7050cb1fb27c7d3f7f8cabdf58164587f6166f459593fd669e403eca078eb7f79a22cf92f694777d3310efa7f0e2aeeb1735be67eafcb0c7ab3ae4efadef8e1d80624a7d6ca1a6f8162d18a66986032410fd9fa0eb157b9d39fe8fec27e413f5fd9a60739edbabee662a7f54ac93dabeced6ba0b799bcad91b87057623214c3b0008c4913c2492b783340e4e49b4d7766226709f24fde9652e94d848a947338f53d518a7e0af8d0b928b3e0ce94149ff225862245a16bfb452010d33ce47ef8e2c4237da780db680ef67382cd072567da3d0a07c5544f6b251b05c8c85d039f5ccb1f9c436d819f32fd2b2f4af94656533787476293415df1c01993e81849b312b122c1589c277f9a75f31ea9528cd56447d66197eb8ef93705accfbcc4520e5db99198f0d9bf4df49375b8eed1cd13fae56a3a4e691053498f1fafad642fcb7583d7aada9b7462c989378b773a988663fe59a16310d086b8b7aef855abd01391b59ec8b71afbc50cb3e2fe92e310013cdbbad7f8479c6de97d1ad1fb24ffed5a034c25c0ba7a32c55aed3a887ce163837903174a8ac84f7132f396a7ba85ef61946cfe038b1e4f9f94c58c7e7abfbf6055fefbde17e0c3705a80184565b6189c3f379ce0a5fcb7c18858557722e79abf8678d1b7a569d0a0cc112affbc07800b38fe687192d2dd89ee3b611af6dc04530bd2b63d367a528400337b33c4b762cf5bb5e4f02492b0a6e38ff367b998d653ef77844505afb02a3f61b867276718176f67652c471c9d6a4cbfa78ba4798adee80faf7c866451ac733d750b5320865d084c2223f5f86bd147bb3c869574e37b57665855b1dd7a652971265fb935b4778005658075f0af0c6de19c681020f1001453fef6d52cafd614df833e596f9a0fa848fedff634e7a30ae6a2a3993c5697db5d5ab7d3124ea63f6b41b63b377b12f36802c3e0db9c8cde55f4e455044b8a9d7f57cc28599dc647cb5373bbc0f88f313fc5ee094b78e93e1b5f91c8eb008ede57c05b5ed9eb4296f4532e45f8a3811eb3c93e57fa8c2f641fe7b2bf126b9651f0deacd9740aa8c7dace2c663b97b1e00eda0e4f0002bf9841d69913961ff57f862a40c8a657b9d452be6db7fdccd3b7bbe6ccfbdfcd55ad396fce1342d4062465b268c48a31acff419a5b980274d481b759c48a73ea329990302709e7420f4200bc0bb936c58002a72abbee48e616e2ca207b25f5cd0889152778a22807603f4ba650f30084452e4f0e0fb2a32197ac7477fab75e60bbe4717e94b03f1af959835a63308e4e1b4c24fbd4a0770cd4c56e3297137e33cbf4fd882195d1c94c01b62ffe539c0e7d1cbaa1e26b66318567bcb60c9b0d781260da6f017528105b394767d096ae2c70a8cd8489d4f65af591687f5baba89b30ccaa55472e41da1a8981a98f8f02d854f790454868f71a556503c00497bbce136009af705ec15fad4d051fbc29abbd321b751ac27ed55d5e2bc3af7fcb47a3fa4f21ec43f5d63ad35944630da04545a83734a47e77a45408338d696de1e59930cd54fd0896634ed0b6affb48a77090f1b9dc8d31a6aad91bf55ab3da59afefaefe26cd4bbb6fc5b9080e7df5a5fbdd4a488578e1ba62a15464aada1249f93e16c175e02b1f9e548fef8161fb5dab76bad15bb99901269f544cc85c3a4af730d53cc34afd4b797967f02374f1fd9f9ef73c473e35cc2c5f0ed27cea2608582a4f6aa9494d5a95a16ff98c1de4b3029c7027eef8f4e8053c499fa431327fd70f2abc6b70ec9248322d961b4c8f6f2ba3bb8a79a9e0bdc7d26840f087ceab5628ffdef1115b53e71f75857416aab40c1c33372f74fa01eff27c23e1402f9fff1e980a42993b7f05a71876021fbca69e885666b958bcf0e26ba9e0015e8cfa1e717f1be1c7a4555a00945dd10a51479e07dcebe037f2aebde805db72634aee321b129bae691e2cf6f5cdd67ea98ad0b4431d43e0a6a56e224e0f705fb8483ddfe4e3d19a7d1a72cd2fd093083574c8decbb5831895f272642000331ab10e7329f005990d8a9a314c704766c5f180699f22f11441a74a9b9362bb60851218a90b49b17c106eeba7c8c41b8ea1d31bdcde18b37fcab42f3d501cba9a89f1b7dfda3baa22ebaecb8dd3e842032a455fcbcf18ce336a4d8c5d0e7d3f0febbedde232517ba0f69fd65e6f9aba8f178ad67ec96e67fb48a75fa296c9d2908ef7c6baff9491796d2dd01d4fc7c2ba03cd1457aa3a3363a10b1f6275139035a1e52b94073acc84ca6f88410ec7688638ba054b5b6435726f1049fa42c5a719d9ec30156214b2cb1211d69291e273453df6b2713929f70d0e99e0613feb794b11c579dfeadae67f0f1982af5eb71c5b34f3822436395b1e02e21449d7072e9b09549a0b46ab9d202d176d36790fafc5264921efe8605413d91168c1552d8cf4dfcb53680f0fcb9210dc3ded301ab9574fb6df9177528a689fdc436ed3da3c9975983edeae5e3046e51b4b3b6dc133e05ddbc8568ceabb2371b75f0f2691e3eb87a2abd6ea06d09c45bef23602c1b73a386023a1495bbbfd63118c65c06b6b987118b44c833c471c721344d661ef3f147d6970eb35e300b0fae538a89e5f253b7dbb28f90a0424af1ae736745797acb9dff394ff6d909adc7c7415be507f608e594bfee8f7a8ca1c8ee80154d14d7e54cc3f85c17e6b4005a2ba9c6b6f664e0d2fba688ce7a7d0afdadd1246f3e120341cc6d657ed89fce8a16a908ebd372baee7144ca6e4e3dfb3249c159510e6be005feef84049d52283ce28f0ea20c8621e94c2a4f2f3f2d63ef9e290ab4d902f19bee81bf2c47f7adda9bd13ce719c5fc9fda44f10eb469f2760da787a32c3949eb2e2d10b36f7af336526fffc6a14a34d5824059b7706d1a4d9e12299986ab5ed5f633b710bc64b7460dc76bbba969f836c95ef7e20834511f18834d054913e0260ef92b1199295a7e17bfdf8c670cce7d41c8f52652a5d27a50716c6f0cd1cd954d3a8f3df609d810b700e7e8ed5c781316ce4a587fcb044cf8ea5a61e2a384c939512e987395da7c2de7335dadf52859b4a3d0d62026f4b02bbb6c9c5cc8beb94f4de2a056c137cf00eb6543949152d5d569588361b55188038a02fb9e35c92895585d3f426250c3a775470b83429e3649052c00e51bbbd8edffc0c7351fa8ce50e9bb982aef6b1a0c09bd0a6328e400c5099c9c7bd7b17f9bea61546953535692f51f4d504d0d658d324c7a0691ce5196d446e056135e72822d5e0f973aceb78a81b7057e14d4e50067b9b31cfa816ec81e5f8c0ad7c38566841951bbf6a059152f4f58c2cdf07122a5c91f9b720c3f6305f7b612f2583294e147c4f91e40818db57611452a49dae0dd01d3aec6ce71bf4db744d0d466ecd5bb104e5f3da7db3a0b80fdc5747ddaec2343ac8f0146d6743bc90ece3f69b3e12b29c38a694958ede018cfe625d20ea3572abc8cb58035856c20e5a6d8a7c626ecf8482b5c86808365040c677801122fe88ec147586999d9619947155195ac7c61fb952ec8b555894e92f78320c216ac64e7d97006a59ed1fecc4d857fb94edc49274c3b8d9691c7a360741e90a7ce44179861708919bb318a679989ad2ea235dda78955793047db74d71b3eba09e25d7d2cca2749339d46bf7c68fc092d2c398c9b04dcb3d0bbed25cd20a3937ed6c2d21f9392241ec5a9ee3943691377bc4649da6b62996ad8b25b40aace5e25036d0949102e11e6a7e276df3b8fb00696317034c9d023a61d35df036be7128a3a63daa76c8da33909dae24dd4a9174dad62731c6f241a05423b76ccd6e244ecec918b5c237d8fa217dc1c426842e376b94279663813133087eb5eaf98042711483f1c98b019fcace6d7c5181a533362424d088a18779851de031cd6946cb99240eef740a23c26d044eba027886966fb51e3fd4feb7b56ca18726725be14baa523b67a6f3a341ed95c068bafbe24992f83fd355e7cf958d53038b2b0eb5ae9db4b4e9f363020003bd3fc5f02c31de642df83a65d26559b124a12014dd2ada1052d0e0adf2fee030b34ffd929b2e4d661b6783c95a84edffb18ec5b0b4e20667d39157efc8d42b5087fb0913b0c2ef9ba1b1a5011d3dabc89532a9b2611594929f5e43389b98e9d6fd4d0b60230000000000000001bcfe01505bc1af256a4da6696db2bbe414f735f0c1c47270a0db279eb28243969917373bf31533d082bc0e719a0068a78ffb4270a05d617ab88cbec124e8518e8a915bcacc4eb3c0267d019c3f4ed0ee480b85e4e5851809f2a643219e265ba3532e4c98982455bef0ec7ea7ee5c3ea0e533d92538997279b4f9e18770c913b712b77f340519549176b49ffce56d0b4d3e5046a4668d3fe19592939c11eed452cf458c011295f786da49785650b80f44a1a35fd6a33e97550ffb9d1a2f37a500588f5ca00704b45bea0d1f612e0d3a920122fa3611516007bc5e7c406b46bf65f627af3b0d0f6c0e59fa1b6575525de5d7e1fd1d5a9b62fd37c4430b55253a5ec6b661e20ed860d451fa5ae41dee572d241c7f6c97a5b292445fa9ae3bf50edb6cfcb4c16cb4be1f314de8b100ee29163280e8ff9d12b93aa193b9e97ed778ca9f42f8b2b0ab0129ed390f50e3094ec822ece95261408482444b47bab43efd23f4358a9b020f2298c37c2f1068eb8a60517d0408926e753a5f7d1130aa0193bf739a04b5487dad1f150e2113ad06a2c218086d1dd34922abfd5d064b8fc21784cc4c5f21cf3fac1f692bebb5f615d178825d5cf919304ddd062f7db9f41761e1834785e35cf061dcaf5cfd8142cb09d5c24ffc19287fccfc3bdc93bea1e6bfc96550d57d12084bcda340c5d41c074e94470f50280e45e290efe18c145d5277cb52779acbb05cbb6a1434bcc8c43decb3d658ccb5917e163688f229238a37bd92d1cbaee6f34040863ffe8abf157e49ee6cf10e18c32cd31c33308e50536d1404fae1d29fb63bccb65433bfc983ee4e18b198e291a0c77b114b3e0d13684f8be321c3e709a5a86363890a3598017aeeb9c5ba1c48f6649e23758893444689f374888077dbf5572db148520586261928f71e522a0077b85167d3618a5ae8e56817f56ba695d365aee649b6422faf245c34ff7f1ee16e5b96695ac760ce051a0830c2cf1105b2169f53a71da3b65ac8c9529c36015deca1079e69bd8fb7a24b2bede79f495c1b8caa62437f67d9783637213d05c82adf2242cdc667a39cfaf09bd6926ffaeb2f1359dd2424437aaf3b0d3a35855ec97e3bd0f954fc331b2882775e8505f5a3186d0686d67ca899a04a9ddb7535d5113345a40717028656a73a46eebf2f36f7368d64b1b27854f85d18de3503ef340045d14d67c5a648805d48694bff2c3a7e9e00b11c3d4f33821cfe99cedb42dceed6444546fdb80d740fad9942815b4c63262fed1fcb9fbd27001d9a22e63dec1c4f3ae43440e6ab4e881c371778bdcd7c566461d05efa588d5e50a7f75b659401c26c898f07f7b6dfc32858ad9e7ca474c321c93e5ffb8fd1995a1eeaa8eebe36f6f6cad42497dc2de108bf6e09ac462687bfdf2c5c27071ca298d84d6fd02596552f745444050f4c4c9c83d99d62dcf0875ffe8adfa2700c82fcdc76c8067152a88274bbd1a26ac46c263b2f7f40eff4a310c2c253e43a935a9f15487457c2c8b386376de07fefd3f353b5bcdd56922e51a807a78e168cc1666c693ea52ce75ec447df5a24b3330156baa0404c092458c110f68e0d7f7d10235652493db1001c0ffb0a73cb24f8df1ecb4848d540ae7adbfd2d02af2ab7991dcebfdd416b571f8dcc20d12e2f2c39157d5543e57faeeb1959694bf2ca923ad834f5144ebcb382ed23d97646d01e8af708c77621034dbe642891a64bba7b6cfb585bc48b16fabcbde2ab96d658ca937bf72a12327600b461fae1d1b2111c4877b1b182fe8a74f57d8f060d0ac558b11be68884376d24e46b28980a5520b4522357876b5bd35741d7bdbb0017eac7cda287a4cc599ae2759c57cb57b6c33ad7a9f2169d19c7179f431e7ef089113a5377bcff5fb931f03c10454b47fca375a982da8e987d9464238120fb250f9d2d25a1838c2abca633fc0e051c1f75c7df218d212a896cf1e05c1fb7a3ff798d269be643fe66ada084f7c5c7adc51a48c647b437da4ba5dc3eb94695eb5d7dcf02240db83db5d4917dc5bb213f884ae3a631acdc251e56593ec20aa10f0775532567574bf84b5b4162b2db8bd4b3fd9c496c2b15df883f6d9d6d7eabb913457c41060b77de076124872c3f604baeab5ae84233d5f2185962c6d5cb2bfc0ba3c94303d49c203d61bac4758f725b578e62da18f4307861ac759e882ae5d117c37b53d097fbd705f26bd0e62dec4707c2eac6e9dcf1c21068bfb5dfa6b5c1ec11211c1cb2866dd45fed98195f243d36602fe5baa26db7504a7ad0c5cb89d81e615a9173e782dcf810e396fdf22943be8f48d945ea8eb1ce96ce60bd8603ab98c7b62b92af9e5bbdb3ae3f1da7d9fecddc032b1d1f0f461f8ef6af1a1a3da69ed705294636cf9c20357ea2cf46a946480c4482f4db99306dda68344fd3744379ce2e4f6c3e75d39a7d225268694737ee4f699c0b0023aba2979544e886a60e882c808462fac58cf9afacf7a87e354d1e6fd8b2d46772f3b909d1954fe4e6274e257669e09d78f19b8ce663545aaa3d8326872653bdda8154eb6ab88937b06d6e74d031604f6ad553f3093a8d447fad4fa0535ff23f36c23c2d51d9e09feda4f1ee214e2983f6db2ad31e41899ec8a04f1aa171115ae0009ced1180e1d7ca9ae05a9c2d81a8836ff0f80c1cca79fb20fdb6837bc0ffaac2b44bac328dda9369fcdb5c8956065db9f65f7b61dfa0d25bff7a9ebe094a13399c9e6a2bb1e9b263d1d0f6a77501a0c593e06244f2cb0aed27cc03247bbca6d068db9b15d397a39b8ff59a79cb4ea050dbd2a5c650be8e4395e6fccd5ccf1cb0b327cc4f0e0c53c8d632a3ae5628403b7e363611a0660efb2aac703d7ac37bbe07a4ad78a394c14c893e19a04ac9fdcf950702d4ad8c491b3ce3ca16dfa17db7cdf3477106688737844ad5ac4374120b2097e55f833e97a9aa9d1d4f3efcb5305567579ccb9477db60f4de43bfab9e039540c36bab5eb2b6136bc8546fd79d66974aa44f4f492958fee59a040d233ee057e086f9513501606783a9347d66fbf4eae38ac4761b8f352bdf88723a557a6fbf55949d0c66f0e17ae3d3be1fe957c3d7e1485ef5f224f44f6c7f38ad4076f6e7ddff144e2c2fdc05bde9b5cec7d1875ecc1f28d6b70e1ce827cd86834f25812a2a5050256c087a5c55d99a2eb2146089eaf75b5f33bac7b909b592167ffac2cdf515cb8d8fca4ff275a081381d74baea0c6eb44c799b992ad08a8ff29ee39ba0ea9671c9796ab6a803f1636a1f954d42a390ee3f79e4509ebda6dd548e1b685e5aa095b6a885d46921e3a7f12e757eb2c56b740ea96f3d46412038c1a09b95b1db9c4b1b8a12a72729565feb349e7accc3df5041a57a855c898d810b928926f408f5956533834ffb3c5376794c360e411468e8042658435afa756ae17769876a153c1116883968fd812082cc0a0c7a0228921e011909069177945db2fe0996fdf10524e785c0d8996c13681e61f488296a2a977b414749868266524b8c5f153ee25af0e6c2a68093e6e340dd4af580770b2f86274a7d8e295e29a82580ee75e480236f78ea3eb64416ba56d35a2d46e5149710ee5a997f70c06d1f6fc809da86a9fa6f23dc76f34687bf6826ddb50771e64f6f81e09d802c922a95d68f974194865d5b1d26e895c209ee432a4020e61d4300aa2036e191ba5a19ee51b3ce59c502f773c5ac234c04237bf18c800eae7372732c1767e487e48bd0875e1a33c9216b11a2769bcaace916461143b2963d227a2fa2abc51d1ccbf0d4d23b86a6af9880ea3333e14561fdad427a1c79de298f7c06c2687054a380e0c64d3290174ce0c9b00f62b8a689c2c672bdbdf6ebfd7f855ef5e20ba0874cfb3b7ca32f103f963d7cf9b8644a203d3bb03832fa9abd814f5c506c41e9db47d48ecdbb0930a9b081f8a2cbe801540ef311bd5c027a6daa5bf956b140f8de557f6e7b72abc2f912c17742c76812ab59c8dbd8025a5a81c74a91453a7b33f1553e23728f8165ff1aa53c616b12f993136e9148d23ae6e09c998b61f4525473c3e8eb1d7376f43c344690a50000",
     false, false, false,
     ["liquid"]
  );
  var tx2 = btc.splitTransaction(
     "02000000010231f7d9ae7fd14c5227f129f044311c21b8443b1f6a6b1db29e3f3a46f813f69b000000006b483045022100a676be2a74d308f13b1448acf99e70c5c7e338525da44415444d2d66a5a82b6b022016258612823dcb8bc81c455364cc09f8aedc0e8ae4c65d7ba15d3fff041f258b012103b3a787933463fd02c67b3cc592f294be913ff58874e3a7b7fa1a43a10b132a85fefffffff9c26fb7f2e60c38c539cb6595aa88abd997a4541c6ac7eb74cdd4ffb7b16419000000006b483045022100d3a6687dd738f9ca6fb3917c27b4e922af3fa0a03b664d28d10a12aad23cc6a80220501e3f4ab6dbd38bdb8373bccb2dd73559691b0b803fb811432e5062fcbfc9e9012103fc09c07220cfcac31d0af41cd5357bb24bb01edcdcfdce768415fc91edf54b82feffffff030b0642f6e3ef85fead62af60e2068ad836411df09d81f6ea78691cd7d7f53b5e400946cb88929aaa03a14baef9cd457f7eae094c7d0955a458db1fda67dd22c7d8cb0383a49e776a20d627e312bc51990c67d6fef00f022a903172c64aa613874bc53a1976a91431251a1beb25a486ca3455a499b9db394d0ff7c388ac0a71a2da1e6155a1e42f5bd68c91b151e428dd39dd40ef394ac35dbcd77c0493ae0877ace637548abaf714790ce8ea2509589e0ed58534b142393b9d1c29da9b30c103cafc44ef55eaddba8ee4241dd90321e72e54cca84602c3edf6fd87ab27ad8f3117a9142997459f093a16007dabb227d153103a5378618787016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f0100000000000008340000bf91060000000000000000006302000391a3439ae9183f77216a5b9d6ad5e051d6261d4df4252c2cec5e4c00032978a05da48ad03c6c9a5e2ed652696523e0346d196a6fe1e65580d6713831a84bec6d93791b6ec880ff6b647e4baa0d42e1f80309e0d2f120f4a510e8efaffa8856ddfd4d0b60230000000000000001f86701e1f1e41b9bbacd8cbc30d0c801aa4161018a2db22c48e8d274d7a359af140e8f7d3088e14c79d0eeafd9a6193f49436170bc0340552399d0d6afa16f80f1aa8163c0333ecf7f9286e51b7425e980a7e3d6fbab77386cd5d516f693a0eaea35f2a2377555a625575188033fa727d2a4a5b33f2ee45322ee4cd0ee0b4b6f0367680eec10156223aee22452d5229ebde5b9ffc20ebdc9459c9d0cb952846f1390fe6de6b46124a9d16160b4275f9fc219f9deefbbe013e98ea2069d86d2f963026b4568317890ec0bf7c81d53dc5de38c282d953ea8ebd6afc5748fab2991c96dcd4533e93f0c3adcb2d58f543d063ed91b0b785f18bb6ef03fec2e9d4b1c1c93e3eb9c91cb6c65ca015b3a89d30f0eca21b3e8bcf6d0969367864fd1cc605b5d5c92206002a95c5e95ecbac65aa1dc1d56c5e6db0d8290f9a84f68b6651e3415d4176101bd8837aac26f826594bf48b3a82c7687a1adfa054af3a1699a1e5c0d610cc920d2b144d45bd2bdc0b05eb31dceda33afb43b04af9672e03e43b7a261a9bab39871bb57ba0369fa73027479cbcbf15882b0e572aef2ea29eca03a96ce6155cae0d8ca44bf4cee75cc0c3bd0d9f809c7dd80fa83bbdd207fe727fc80f6b1fbda871ede9ae1562b7556ec1cbdacadc5a9963738a4715731889e5cf6cabeb84156c681305648c40dc633a4c8eed110100c60947293d68e2a8b6fa3f994710805b0a9c772a8a295118ebb907b206713ad8b7649403c7757fa995630c1c13dbeda214587f76faf9b94764183f932c8510197f615585aa3c44c5b33a37aa4bfa45b1bcaf45025fac25838d4d069ccd096285382009b941b2c9a6c75d2ed9a1789a49a186fa67dea07ecc7c691a8683287e6d1724f96c1607eb03b6df6fd4a678e98005850120fd876398559310bb5e96cc9cd08af1fcdba08ed901b18c7525da853c7198f6292a0c7b8a13d73fb40846dfec2fc08d7b4dfd19cfba93cb9051cd4b7de4c16ac2151433b5c6e7fc97a0c27f55f56b5657e2265670e8a1de5bba7948603d9976a831c843ba4fcc04ba5e73a7132705f93f35839ba77f0b69c6a2892204365f2d7ec2bf4b98fe1e44a6fcea6cf66dac9e31e90830cea510c89963ea06a98ef47b0a2a7efb1e6525329159df1ef4f903e5089958cb589033616b322181ca1d5508e1787525dd566716e4b184997843a2427f844bc28ef223261a8ea7e82cbfac5acdccb5f716bae6aac77550a36f653b257770f379e0ce4d78b4b50085c30756f4c45cb89b4a5bb034f2b734dbf4de858e4bc9afa487bfdf1044309953154750ad257681456e4aa190633bb35bc88d1821a73e880f9ff440c57a270f22f15a7c5f5165f03f72965e1caa73085c2aece9d16600efbba9a12992c28eeac2a6d89e01fed41b21a81813a155b65bb00682afcf6fc370e30ff984b3a7952dd374c146047df1c08ef265b0ac74137c2799b64d36392ede48f614eebc1196c6af7c19dcd248b6201b92e55e136ab0c8affc6d0aff2f3f847306c184ff6c90cb19a649142e904e1b626ff414b5dda20ec60e342810c64c16eb91f7b74c27ee06f2d33c7d14157c4f2d644c16189b7c6c396ca8d33b528fd62dc6d5135db360b336bb9c4a1de1478a74dfb3a8041c0f6a9b95e04bc946abcdf4774e1abd3de68b7bc735c9b6577b430a10373324ab93d5d911e206aa0365580063ee46977226ebe6c6181f43fc0afd6bcaf7158d5649292fcbff0d6163bb3fede6c554f15cf91efd9ec5da3698772b2e5298c1730acfc7b262f93ff6da9842defe37a00c13dc88fe5f2997e07e1954164402af1754206815e4349a0aaa6e722066c51c3cc151b523cd8356ced831973121d6ab2aca5c8a18b20a6183f5bc1edbdfd5976ecb16eb12eab968a566c82737526c5aa870bdfb7093d5a97ae15b935a33f0e9fa0c0390020c94e4499defb9b1d089bdacf1f7ab9f05e28136a150ce517f0978c457e3324a038e9e266a6a425ebb2bb2b669540c9b6e9aa91fe886c433c22fb86247eff096997a43aa65fdae40a552dacd612527c9ee98c972c164cb398422a0668347e0174b8a8e49ddcfde7cf95ccb27d59f7f9698f08eb0bb2d04459d2e99557dfa07426a05d057e257d890c495fdd0dce6d32368bf773345e4c7d1bc5b9673b6b347f39f4fe16a6b69bf603569810d70930ff95a2f2d8b02c4bb79eeadb5ff26a3cd04d03ae1d3bf104d1cc236f2b5494d6e812639d14224bc3528b20a4359bf1e3c7484cde70e2499c98680182eb1d7f0903e729b889c436e970723be300fafb29d749dc20b80448428ad5f822b3602b6dbe890ec62d77fb2e0dd17192b3edcab9031effae96d50875b1ad0cd7b2f6dff75bd3dc504f33991b677519fdb8f0d9f1a64eeac89baba7c97d9cdf37594d54ddd61791b19b0f8ec45adc5c68d2b091eccee6a620a6ebdcd88b48b46513e647a17734885ae29e313251d07a2e3f836da1e1c89980316d154b1bd1f8cc7d616ce5eb52516cb7bb199ffa2b85620063e0cf54f318cc95e96513c6feaf196623b5ab965b74c862efaff040a286c9043c67f525762910bd38be23bd30f4c3f5f9ddbbbcb4eae92c7f2520597dee8421dcd55afb24e031fc07ca222ed618ae440831b2a0ecc86901a2cc6abb279749526ad669d42fc4608679b92fffdc0d085233e21ef52288f866d3122d5ff353c01e65d6a9c7a0db5e92e5087403da309de19dfe71d6ed69fbe3c26cc5fb7d6a94f9cfaf7b1c1dbdadcbd680a33295f1a3044a8638e07e5ee5904b0baf6ec8e6ab073d35122c83a9ff3a6cde0a521a131f66793b6c44c10dec3caf0d4348d70806f23db2e0415e9efcb1be9c109f80741b8b41e7513592516a90820a6082f8adb4c0ce68f74acca76a76a914982fd5dc4df5c54ff80f5a6c52db35819133c0e39925fed3006c23b603367e59fc2582333890828418108c48cd182b6175a9e2ad729a8d391518e55b7159e4f4b3d03694066ed750c90c72bf26347f7a2777aa252390d9e41ef0ee2e1774b9c193ad7b2101dba97ea16f9875e541963a588829f775a6a5fc46ed76ea361eb8b35ffb80e3187ffec17f3dd3190b5151437d028fd5f87b1d78744fb5ac8f9283c20ef67e5d26d44e209bad31b4dfde96344c2ce6eb1e5dc36940444d6ee073563ce372507b988e00f832e6b78658f78b0392f0de54c635193b7d5277fd7fcf454f75301589791c882302c60a329758f9e948a5fda29bd13bdf91373ce0c7a9b22c51205ad3a19482b295689c6619b5bb3a2f23308125dcc447f0e0eb5250273d7535acb10539594ad2f0b703adc9f49d3a2ce653d20e3da99ce9fd7a04012eba61ed4dfa11ea15f5dff8f04e95b3c1ee2b785baaa14cbc2e3d014534451d3f0c8e41f9a384c43e31fc55b4111879097507e8e0b94a5f39d53556c655bac5622fe379c703a7255290e0b6accd85081ee0278a4a31954b6a338ab9f11e80a845694fc7403a111dabb685e31c6942b5b8b9aef8f8ec82ba19c9a4ae5e9ebf309fbdf812a27a78fca0462e9c33ac63d8951b6063b44e60719f4047e091ee0179f2a695d85138efd2f3b3537c370717e30d3d6f8df8b3bdaf925d7fa51e75a3de4111566b89f7d2d6b85a6c9082fc11aa41f5564cdc5f4d55d0bcea4adfc1bab91dbec388bb598b3056f489e11237975d14f7da82da2d024a8e537e16b98c86acf3e9e8661131d8e6e160afdb3c09f2502855b1b46a4a6644b30a8693948ab595e0989ec55919ca9b900f55a6167b7188adbcdc4baab3f496269e7d0b33d9f8c23cbd3e841f09b0f9a400caf4d839f30c0d6cfdb0700fb30a3b120dbb32e324f1ffae324d0228e62d8bf707969953ef57cf3572c0e5a0ef8c08b4e295ab79c3ebf11ce2b45f2d1ec81dc73748b449a1cac3a8b2f12c37be7aa491157c97fc1a5e5c8edbb463e77b4131ffdecb61d57f41d7d70d191132d22ecf79a5b88db0b7da59e85c118ff4c32e06a02c75fb81e5c1ab68072501670ed1b9f6ac6df16e2d8426a39d13672b1e7fda866813efbc1f3b9ab220e3d3295b8e6a33a43fff630200039274c14b23c0fd4c889ac53f0eb5979577a43975e0d3d70c6a19c18cebf8b0aa4b8041fc09c9dde14fd8326f83db1e40ad8e488f6b20798499c94d32d5282445cc1fa64198c62570dbd5b51fa8f1922cbd5ee952fc8531fba512936f184e66b5fd4d0b602300000000000000018e9201719a0d33d7445e8d9eed9045f7c1679aa031fc7b81d272c9734a4f18bdbc99784298bbd8d3e651d0af0f99f5c8d5d03b2d3ac2e2fafa0c34d6c0bb143b0ec3ca08eee48c2cb736ae28e41b93562901d2719b3be1cc825af448374de7d1e0acf26a8f5b1dffe1c14415627b57f8f946f103067b455047030898935bd0fc8a472f4c9706a80b99902e740c04e51fa0d20c19c4ce51ae2792b21115fcf266be250f38da69ea443ab4a8ac040059d5563d38c6a362d9bf79d2955601e66cf465fa38a875b8737f51545d6ee69e48a99fa1e5af3c10e9e5c7a005248593eb89020a5a9b31fa39083fb7013d96541b2044ddb825a380b2fc8c5e44e8ee83816ca1cb7848f805b4ebbf9fdff2a7c432a6c46b30f0bfb0e7879fac0bd6623b703c6359a296fa7ec0c170c891db3d7e0ff6110f7dcae0570c902894b5e29f557044b9cba681ea893ef7266f408042c33a0eae19f4eecae0810c3eb6467c04742ddf623d1c8a967839317072256a11b4b2fe2f6961124bfffbb72d05faec13144e8663b23329ace3904f7fa364641b6ab2488c3f7228260cc0417597bae00f3e79362b06555d693104709712307d7bc98c8283226d8d8d0196e325f9746104fc1e43aa5e9bc8af4f4c75b7279ed3e95a93db3e1f3c23cea251435b38c0654aeeb91256beabaf97cad396c4bc00440143d167e0a9df8e6c1c09d2a345470baf4797b6bcac615039e3fd2ae663f00b86db1d3b0f8b90fcb78fbb0680bef0effb4358fc58015067007d67cd519f1a401ffcad3ae1ecdb425a15e4dfbe78604adc9625c08ca48687061ee4c59b71fd992cd652df13e536e23165ee8d28d6d39b25cf5f447e6be7dab30d6b84fce2586c73bc278dff409b0899057c2245fa2754fbc57fb5abd97d856d49c492e36af8a661854c75a10a262ba94d96924e3c6cb5cad498feaf91b88ae83661baae5854801477dfea76f41531a34e5db42d96746ea4c3c38322ba01802263f70659338c9be45455ef3c67d8625ad1cc95bf68c6267548c3352e90af24c26b1172902d77e86f9015891767b4b083ba15bb3a15fa1cd79f00344d74ca9c5626c4070da16c9c918f6a2c429264963b10f588c72b09642cc4f946a362b6591edf9c91c3ef61e8bffc8345d7aa84bb432b506007a8058b1d0f9912371e6f5fd417c4ee80524e634e722feb145fc5c2387dc71ad9cef3708bbdd2403344b3b361edbfbc22d084328b50ce7f040c013fdb38cfb6217c6620202c8c171e62b67b286c2f191fd24d8423a27f0deb157cf53720ca333fcdff9ff6188eeb78d8ad412627a2b98bfe818ec5385df267e49c8441404bc24ab524b3794eadca02d1448db6b160ff15c9ae6ce03b1afa1253447fa1068d9fbb113e05ee43125a70e474909e8aec17373237f36c0ed785bd710bf06f56e3f10f0c854e370f6fef9598321ac4242f7b8e3de6c61908201702e87ddc95300e55f320373009e1ef84df8a6a1b0e284e41b59d332140d3dcc575d1f0b486a97d69575308533294c3471c1bf6108cb2957ee15f838cb9ed5932941c9a0f0b4a5ee4919678b77e00868edef58e8f855706f43867ce99f6966eaf8e0347d71c6de0cc10f6b9e85350f14879154841e283ad6624346c6c7ad98618f6f975018d94bd1f52ced4860f50c46c63c8283265084ac8b76efde5404157d052095f22ec5ee327b46eee4fa8f334686d4296e327c4bb614238e542b6d65a1b9110436b722ee73c9b9c110acc3cd740b3116e89513daad241fb024b9b304ea8d8cd11c3c5c0e65f5742a722d05f469f4e25d3cc672df1d198f13566b6ed184ab7f64cf58697da21c0a6c8c1cd998f67333fb0b953ec70b668c28869a87b7e2444427eb0c71efcaae4e2f0f4d7b73b44f073978edb4a8a100b81f55042ad713393b8ccf6f2f31e84e37420add937bb0ff1312ff6a7ebf124d9066e2b75fb8ab4d690fb89416aef634575d24352c340dce3a07d8f6e984f9a901d665b3ffc60e0bf77188aa17e030a6ebe9e838ba3f998e88cd34a0cd8deb01bb40f8206b7ee3d5dfffa4c724a3bd1569d90c7668a3f595089c6fc6f22dceea7989de2bc277ea56c4fd83cedfe4393c32ff1d2d5f82e26a9d9cf4d760d1c01fc7309297ae9626c6406fb1d2b2e30686fb4b6870847b46e2fb91a6df632a6d3f9213e5fe8abbf94b66cc95bda0ae690b2f0c0d166f5981e0c69468d7e9ce9087f1d7b54312f204c5548e4a307e40bee742305ce22d27d7a49bd552553010d6b7f2c330fcdb9131f9ab0ba3b77595852fa6932b02caa8a593bf876764085e65bd200fb3b6614d0d273e7f05c758fc55c05eb1cce9d88c66131dcdcb0b4f26aeeb3f73aea4b547655911892e506490734e6f27dfa5d4e3541f8276220663caca3f491c5608144c4b9f26c9a5885a1d0b2bdd5c99609dd17b2587db6f087f689d7c3424237ab2a902d11effd78396c8fab53983a7849a8ff033a37dae0ac182568f5967a378832a21a8dfb42e4aaa713b2a4c8024fdba9c073b3fe3a7f1d02b178ec600cdc513d0a7ea958c4c0b18da422a000486661828c8e913891ef772f323171ac9a279816a329fd33c90f20f8d6fc0ec9465fce6f65bc1c127c97d0f75890c76cf85fdef572a46dc8571d10f009d46af887632fa04658910d564c4acf87c92fb8163292b0344314864bdc29bca49d45484f494d0c4afa76e031e81802c7fd2bf3530e6f5186f24b2f29f637164f35e4fe9c1f3f68ee1a2e95a032788369af583aef7aa96ef60d41152b897a26a0e697bb93f9e442a988051fc24a97fef29461ee8cf7bbdd2ed01412d8d242325542065e446cc7d29ebf66e3ad25ab6306529de703df4f3392776fdeb0ba579a507ad4dda3c8354e7dcde05d3dc254717d1037270cbcfdaa2e89fdcc6564fd83d93f27076de61f9f513a65c222e95d423f6481fbde1556db5b83ccdd27a887fea10060ed0240359a97698ea992d7d7a48bad36cd2bc20d0eb50fc3231fe32d1939bc3712536c611a17d28b6128e6909c1ebbf5eb14265c5dac47735f30590c47d419352e28d2a5a4a0935928277893b6cb53db1749e2688c4c7f0198bb28dc7f2645ef2d01b6ad13ea406458e012a306a7c4e00e6ffdc6602355495f4fd36601c62fae7b2a63872db58bc73a9c7c9ee7d6531c0294e7e71aed04441e8b650c2340c686346288b09491b768444af8a94aa7da144678878c772711e13e0815f1057da1c18c58ddf1281aab610ac24cb3689529ce34e25ed6efbb0d4171b282cb203f2ceef0851c1a60c1a9bd0e0718778e0f64ec671e246005835d0b69d70b81555c5f316f53405f2ab9d597acc137583e38c2f0cd1441dd9ed1cedf6757db6edb26b30585d6402ae65c86fefc773e44ac0a9748631139f592b44741f621f6568b126011b79eb04581983f33e74841501b4b031737712a4c84bcb735583914a3ecae82d51bd62ab85817d69e0ed51b36cd1a81853efded838816ae4384cbc6e6204edc721da8d1afda49f520596e1ca54382ede86d7d7e8476b4ccc22e44e66b19c7c62fc8d197b39aa86833a11df78dd59555d27e521990d5e8a2f6a83a541cb23fac11c29f889aa9022a588ce1b118d41145ebf7fa5d21f87ff209fb799edc68e2608b4773b2d9dcf76b84d26e88ef47af18635ffffd69d4daeaa242c4d30da72689e8b60ba7b69ffacf7ccea3f6624f27add9afe5a73002b78fcc708b375033d73a3418d6ff1edaced72a07d7543c822965d9dd252ea8da766d5a0dcccd13afe1e16ce08f4e4167d1f530930ed118343a90a1d293fa8f274e62794ae5bdfc4f64057aca097d2936967374b980cb72b9e5da1ffc501ddfba27430933aad887fbe85fea577063323aec67e437886ba98c30f55efbc97c4e32ef985157f86e2e5457f7e249f56a789f1ecf8149b7f62371f5bc8150c2e288067951fcb4ab4db9dc97c1f39b7668e6bff20a678fac33e28b97f399257e24e21c157b4fadfd68a74083165301b7a347eb97b09ce9e0901f7fb4608a0ad36111a9b706716835fd86cfb419eaa2fbaf78f79b071d0d340000",
     false, false, false,
     ["liquid"]
  );
  const result = await btc.signLiquidTransaction(
    [
      [tx1, 0, undefined, undefined, undefined, undefined, undefined, "30450221008b5256dbde6b6e36d1c35abb756089ea6f5a30269ed9ed921506e0070e7dfb6e0220581edefe0ba8fce11441e97d4b212664c49166265cccf35d55e8a04e4ccee85d" ],
      [tx2, 1, undefined, undefined, undefined, undefined, undefined, "30450221008b5256dbde6b6e36d1c35abb756089ea6f5a30269ed9ed921506e0070e7dfb6e0220581edefe0ba8fce11441e97d4b212664c49166265cccf35d55e8a04e4ccee85d" ],
    ],
    ["44'/1776'/0'/0/2", "44'/1776'/0'/0/3"],
    undefined,
    [
      [ "00000000000005dc", 
        "6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d", 
        "",
        "00",
        "00",
        "0000000000000000000000000000000000000000000000000000000000000000",
        undefined,
        "0000000000000000000000000000000000000000000000000000000000000000",
        undefined
      ],
      [ "0000000000063bb4", 
        "6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d", 
        "76a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac",
        "02a6a029194366caecead01565df27d779e7ac405de3b38572fd9091080f03d77e",
        "020129d9733769531b80adf2a6ab2f8e212beb26f94ebc2afdb43d5b04cac794b4",
        "91ff512ea0bef8f0d075a5a47c82e6d46e845e49e5e7bd2348c9b0c6afdb10f7",
        undefined,
        "1b691220c65075921aaba609c6b1d4edda22db228aa129e142f8720e741087e5",
        undefined
      ]
    ]
  );
  expect(result).toEqual(
    ["3045022100d0d15a77e16f171c51a445c417ecd9e0ccd82bbd825b06b83cc44bdff763b832022025b5d2242f59bc8a10a3233999036e4e633797ee8f316922626db5d2560e689e01",
     "3045022100a1aa5a026ba5fc51f167114e4df2c7574cb9c6542ca2cc45191de2a7a173d1d402203a59439ee34d3a4230488666a31e4750facff5d88a1c0888d25784711e9b65d701"]);
});

test("serializeLiquidTx", async () => {
  var txHex = "020000000101e46aa5d11fb7f2243e75bbd90ad94e5ae0d1992c4a5c0d6ba71a77e73df8e23b00000000171600142851f8219e77b0f3ae8421a8274168c743e574d2ffffffff02016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f0100000000000005dc00000b547995d08f8fa9e87e122548afc2ea80f552aee8e45a44df4cb81292fed26530086bd721b7048f58fc925f56b0642e107a492c9509b475186f7fd573e47a500437020129d9733769531b80adf2a6ab2f8e212beb26f94ebc2afdb43d5b04cac794b41976a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac00000000000002483045022100917ccdbe993dbc4c0bfe0839bf7df16eb481a175c60a7badbb676145e75f924a022012a868a2286420a3d0793e241c4f767a95c985db7c44a0c8a0e872843fc230c8012102bff933ba22e896a0cc0a0834f11c6afb63995605d4def392776a26535cea8e9b00000043010001bd2e6fb69a23e881376f7c692de1aebfd700a905c8a30b493a855685e939f870adf7d6deae5197ddac0e685b0030e76488ec549d4467a4fe1d8e814b3a453878fd4d0b60230000000000000001ea10015893fbe5cadd09e8a2944bb85a3ac04a65a345fbfc5598d5590624603335faec0351b03a46b5a9cc763ee1769badde123ec6aa62c9c0f9f62a868f8c38b4e20a2abd02e74ec5076b38d7893d8a7eb6677b1fa4e7b26716672e059d4b2d4bb965eadc0b1f2670ac51e8e97d9d5c1774c07ea5555ccbb27f7ebc3d7aa0a8eaf2229780587d2289724cc9721d9b0db71f799d59422f95dda24aa357253fb1b411f0538646120a92227e13897dcc8627a6a915f568e9a4ad56b165002c4e9f8db6d2f5c3b6fa5f81851a7c0d70360e4a6504eab5761d79a992f1a9f94360b20027c6fe190deb6bd1b15014f33d6c958b3d8b33b2a7f8385674a4c043fbdffbecba492c5fc8e0bbf2f6d5221a6aae302454b902e679f7e28805a7c351a4e0ce238857ff53c27dc390f3d5ee56d288e92e88da4f51a38e509886fdfba9c957eed31d1549af668bcac6e62886416e4a0ac99c873d03779c5a19ee154ba8c4b12e689e095ea606c024d7beec052e451113dfe1cbcedc182f5434c490d867c3d1aa0d56845b098c87372131e898f74068c4ee43ace49029fd2903b69e0c7fe01a19fae0436880077818cca0c2a8f01975eb3580ce89ae8ffae76bf01ee77a576736eed52849b9584a87eef8b05446d34a33e77ccf117a6aaf3acb0e290e8a3cd5020a6ffe32879d81dd473d0c960052d67825341b1de30b8cea5fe94b9f024bcd6ac2f5963d0ee69137b08714b168d4121837e490bab2815e384d0d15c6d98d990ca61bf648e6fbe89c4b5b22eb7ad68e1688f17fbccadc1ea232f7c4cc10348b9f32ac1ac966c85a7c30e7d2f5582d2d327f106197f19994b23c76026fe034f2e90cb0c9c85ae5693d3f1f9adf9391f70a3d50e0b2ff0e5fe6062e2e62689e5eebb3cb1728b0f553bc5bf288f178240ec4c2028387be30cbfc7d95219e6aa14df11e850c1eed06c3b4e6af58619f4ee93e826f548f6d4841e345215b97b90356d641c367fb478a7207e170fba9d9cb1eb75bab69ccff6f83c28d48132432571074503da5123f09f406a0b632b03d18d2a6320da8b51d46b13daedf69054f352a29bb7e5b95e14f0fc8f2f53478a61d2e754aacaeb7d1287eee4d74b0892263d09bd0423c50940527d404bbe1135c683465553d558f79c00e6cd88ba833fe72732cb624e7c432433236e2f80c5d29665d909059ad1b1dd17b8a5e1cef0bb6a3ff10908435956c82b8347e0871b36d0f1d7b46c12ac2454af4412ac5675621b6feca07730fd14cc0f3d50d6485e0b59ae6abaa064e0514b24c57abf5bb20740b15ef6d64f249bbda993c8f90a5235a7170572cc5e213fea65cb9617ade120349cefaf10e0a945e3ac039021a2dc3652070cc4bdfcd5e2d451bd6bf28f25e4e68f5832b21566829fd37500ac1ae6429132e97278a2bf82074500f5676dcff3adfdefc88daf1a81ab23db5fe7089154219a258518fb204b3fe9ad572bc47fd4c5a200a14593cc7efe24b7d98144ae35d4e6328c76c1807168a6d799ed3aad5f4586bc1437d7cdf38b026b9e131f39d0bba348b6598b7fbc9f2c9ec0bcc03c28329b416bffa285644031d489e86d43ef12b3f42e76c36e5ae9df1f3ac0f1d9cdd5d4d7c446b19d1d8d9a58c93ae27ff8daab5e49104b991b38ef4dd848d9898d1814ebf391bf57a9314f298268c5fa884c114e83a87210aa8b483be9c3f5a4eb345af951bfde6157bfbbfc7fae28297a534f2651d5c4f11314b29859510d8fa99127435c30c2e99a308a68e6b699967fe5b5ab35146b758e876450c1a03b9b90fcb7cc05929680ed282d93e53c1d56590928b547e10222db9ba6f2d8d0afaa93af871e4a8f9d9e69f07fede10ec6f088fd5195349e566fa420583822371ab2778327019548de0ed9cd4e412b14fed14f768a6b5f11ac26637779dac567a2372ad033fbc9a3ada97b10d6bde95fbe665215068a6a9f29872d102a14c7edcd0ccd19f47c09ddef7aae4d1a2bd6050806c662e4669391996c869bf94d3863589f96b02be28d045ed7eaa92c399289de5b193fd4db5da347fee11eb9b1ac901a2ad542496b8c869e0c55ef27d8b7b4905fd24d652789dcc89a59368f0ca0f0ea8c99b4d12c14c35e77a96d4a0f0f38044fa51125991d655c85988e150f7bc3b8f9c69e6b1df46feafdd74aef1e91b7075f45dfaab28adac7a0cb3bfb5b11bc21e3db880448ff78f6f32335d218e2d9ee5a99b64a2649c66d7b7385bc9a7ae3fa44f937128e589f4fe99ea601e40c1b61c53c06657ea9097be13d546453d5bd2864db7f26ed5167d9268584165798aef967260cf8f96dfb9054c07013e1fbf59f550c43017f753ff4ee7afcd47e0e7f682376cff563778e062362dca0c7b1a7ffcce268f42832d75a42b9358720ef827a218221810fc8c28f10d5fab56fd5cce327b1c8d5f6b94225a97855a85783cd9e0b15dc05317d4d70cce6c010205319985ae0e6cd9d24e71c7904d3e8aece8b90aa81eca459c4f2627556dbffa0126b37bd07307e7bb8b01d53cd5f68900ed066392f376806b56790afc249766cd98f9bcc3aaa69c22fb5acdbd320e550131ce16654ede5077043db69a541b8568c715bfda43ea72673a46d1657318629dd83843c60fd5f296f5e26f5aede395d4f46812d977b1cc8a0f1396319a196268f1904e7c9b10e4c191b5f233074dc047c8a1d4733802789a22c54b8776d877dd8995b6d1e8d22f2efd4260a50eb4fc86b9c144242630217f1f2ea75981f4cc02025332c1683a60228eb73d10ceb179a59d11c00b55976fe4ae48e4a5b2a6ac4718923c511d241c63574065959620653cfde157ae5494ff4d2eca43ee70741f13eb8e19875fdc265e52087973e51d374ff7f1ae8eb386347749d39c886f670fd580ce2f24c1092433d76c7cc030a6c5495665dbe0909eccf8e0f77b268fc4b87fcac541599ae1ceace33f50b02d952a7c60a1dbfb75dfcba104f41c85a7133b2d97617874d8ba8f10ed5b5d1d5798d495384088a6d6a6a4af3c3bb755c5806bac3ad273af1dd58a6ce1bd5f5a9f9d2e2b24e2ab75ea9fd8b631ea29f07d1e90517f1690a110530aac7b29c8fe468afc2be93d953d5b172e7c8668a2658f0c95c96043ce03e5f57857e80011117ecbb6f10dd0e0c3deb269b24cf46f5d4ac875e8bb461151cfc66b69ad8d15d2a4ebbc247a20983d94b6f92701ab25bcdd2b768ea44b3c009c150d8aa71fc4440ac0ab6622e29fcc15629a82f3e07bca6eb6900f2670b219ef2ba12edc1a76b6892efb025e38a7a7b1f0a6ac36caa6abf4851ca811e795ba710709d788532026bd134f7ae9c5f3972a9fbec5991f9bb1747eb4064c66eb2e4161c901befab36a9bac48d9b77516a36a722dd705d0da3db493f72bd7195ee8ff99b4626b857e9e34fd6f29f077eb2add160266f7364db4f2b6c39331352f95e7377e10629f9478b5ee57165ff0cbeff7c6481c7be82cd245c462d0ec9c79e35fbc6dd44c427c2a85ce5b79543ea50dd909d59f7de80467aa0e88c8dfeabe74961db74ed4fe9f04454d21f4aad89c26da4a6f5299565edcb1991f9c9f28271604b6540d0556241e67a4d613f4fb0c52ef437c8da0c5e3bbe4798c8659cd393bfc7d10a13edc9c18ab6809cde93ae805c6ee2b3af72ac570678bb1dc0268ad034b18092b8bd9c6f97af6ef0b9d958099b5fe4ba0dd08f004e7d36aee2eedea403a004486eeb22ed71cebdb3413106c7bbd826a7c6c4efe4cc0deb1861212d2bb535c3adefba28ebf3623bf2782bd4600fbcc6a9df20002a47c54cc660a6b27211a8d3dd0444e1a2298260ea6ffa6088ace1590ae7ee9951f7f620e55b49beb0ec8ad1262c98b1ec1b4fa75fd1ff4931b71388e07b31d699246ef6fe59bba6f69b7111ea73f51e685fea3798d2d74fedb900c9ff6ba2cabd150fdf936eca041eb27c38c529767ab14f9b1f9b694c3f2d103779fa3c5d2c75fd287be2fe4169dc05951895b884247e65e8a88ac6628e1abada705287ecb1b3441402dbd6bd0550042e5ae6502d771b844ff46eaae6c61bee5f0ecbd3c61df";
  const Transport = createTransportReplayer(
    RecordStore.fromString("")
  );
  const transport = await Transport.open();
  const btc = new Btc(transport);
  var tx = btc.splitTransaction(
    txHex,
    false, false, false,
    [ "liquid" ]
  );
  var txSerialized = btc.serializeTransaction(tx);
  expect(txSerialized).toEqual(txHex);
});

test("liquidTxAuthorization", async () => {
  var txHex = "020000000101e46aa5d11fb7f2243e75bbd90ad94e5ae0d1992c4a5c0d6ba71a77e73df8e23b00000000171600142851f8219e77b0f3ae8421a8274168c743e574d2ffffffff02016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f0100000000000005dc00000b547995d08f8fa9e87e122548afc2ea80f552aee8e45a44df4cb81292fed26530086bd721b7048f58fc925f56b0642e107a492c9509b475186f7fd573e47a500437020129d9733769531b80adf2a6ab2f8e212beb26f94ebc2afdb43d5b04cac794b41976a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac00000000000002483045022100917ccdbe993dbc4c0bfe0839bf7df16eb481a175c60a7badbb676145e75f924a022012a868a2286420a3d0793e241c4f767a95c985db7c44a0c8a0e872843fc230c8012102bff933ba22e896a0cc0a0834f11c6afb63995605d4def392776a26535cea8e9b00000043010001bd2e6fb69a23e881376f7c692de1aebfd700a905c8a30b493a855685e939f870adf7d6deae5197ddac0e685b0030e76488ec549d4467a4fe1d8e814b3a453878fd4d0b60230000000000000001ea10015893fbe5cadd09e8a2944bb85a3ac04a65a345fbfc5598d5590624603335faec0351b03a46b5a9cc763ee1769badde123ec6aa62c9c0f9f62a868f8c38b4e20a2abd02e74ec5076b38d7893d8a7eb6677b1fa4e7b26716672e059d4b2d4bb965eadc0b1f2670ac51e8e97d9d5c1774c07ea5555ccbb27f7ebc3d7aa0a8eaf2229780587d2289724cc9721d9b0db71f799d59422f95dda24aa357253fb1b411f0538646120a92227e13897dcc8627a6a915f568e9a4ad56b165002c4e9f8db6d2f5c3b6fa5f81851a7c0d70360e4a6504eab5761d79a992f1a9f94360b20027c6fe190deb6bd1b15014f33d6c958b3d8b33b2a7f8385674a4c043fbdffbecba492c5fc8e0bbf2f6d5221a6aae302454b902e679f7e28805a7c351a4e0ce238857ff53c27dc390f3d5ee56d288e92e88da4f51a38e509886fdfba9c957eed31d1549af668bcac6e62886416e4a0ac99c873d03779c5a19ee154ba8c4b12e689e095ea606c024d7beec052e451113dfe1cbcedc182f5434c490d867c3d1aa0d56845b098c87372131e898f74068c4ee43ace49029fd2903b69e0c7fe01a19fae0436880077818cca0c2a8f01975eb3580ce89ae8ffae76bf01ee77a576736eed52849b9584a87eef8b05446d34a33e77ccf117a6aaf3acb0e290e8a3cd5020a6ffe32879d81dd473d0c960052d67825341b1de30b8cea5fe94b9f024bcd6ac2f5963d0ee69137b08714b168d4121837e490bab2815e384d0d15c6d98d990ca61bf648e6fbe89c4b5b22eb7ad68e1688f17fbccadc1ea232f7c4cc10348b9f32ac1ac966c85a7c30e7d2f5582d2d327f106197f19994b23c76026fe034f2e90cb0c9c85ae5693d3f1f9adf9391f70a3d50e0b2ff0e5fe6062e2e62689e5eebb3cb1728b0f553bc5bf288f178240ec4c2028387be30cbfc7d95219e6aa14df11e850c1eed06c3b4e6af58619f4ee93e826f548f6d4841e345215b97b90356d641c367fb478a7207e170fba9d9cb1eb75bab69ccff6f83c28d48132432571074503da5123f09f406a0b632b03d18d2a6320da8b51d46b13daedf69054f352a29bb7e5b95e14f0fc8f2f53478a61d2e754aacaeb7d1287eee4d74b0892263d09bd0423c50940527d404bbe1135c683465553d558f79c00e6cd88ba833fe72732cb624e7c432433236e2f80c5d29665d909059ad1b1dd17b8a5e1cef0bb6a3ff10908435956c82b8347e0871b36d0f1d7b46c12ac2454af4412ac5675621b6feca07730fd14cc0f3d50d6485e0b59ae6abaa064e0514b24c57abf5bb20740b15ef6d64f249bbda993c8f90a5235a7170572cc5e213fea65cb9617ade120349cefaf10e0a945e3ac039021a2dc3652070cc4bdfcd5e2d451bd6bf28f25e4e68f5832b21566829fd37500ac1ae6429132e97278a2bf82074500f5676dcff3adfdefc88daf1a81ab23db5fe7089154219a258518fb204b3fe9ad572bc47fd4c5a200a14593cc7efe24b7d98144ae35d4e6328c76c1807168a6d799ed3aad5f4586bc1437d7cdf38b026b9e131f39d0bba348b6598b7fbc9f2c9ec0bcc03c28329b416bffa285644031d489e86d43ef12b3f42e76c36e5ae9df1f3ac0f1d9cdd5d4d7c446b19d1d8d9a58c93ae27ff8daab5e49104b991b38ef4dd848d9898d1814ebf391bf57a9314f298268c5fa884c114e83a87210aa8b483be9c3f5a4eb345af951bfde6157bfbbfc7fae28297a534f2651d5c4f11314b29859510d8fa99127435c30c2e99a308a68e6b699967fe5b5ab35146b758e876450c1a03b9b90fcb7cc05929680ed282d93e53c1d56590928b547e10222db9ba6f2d8d0afaa93af871e4a8f9d9e69f07fede10ec6f088fd5195349e566fa420583822371ab2778327019548de0ed9cd4e412b14fed14f768a6b5f11ac26637779dac567a2372ad033fbc9a3ada97b10d6bde95fbe665215068a6a9f29872d102a14c7edcd0ccd19f47c09ddef7aae4d1a2bd6050806c662e4669391996c869bf94d3863589f96b02be28d045ed7eaa92c399289de5b193fd4db5da347fee11eb9b1ac901a2ad542496b8c869e0c55ef27d8b7b4905fd24d652789dcc89a59368f0ca0f0ea8c99b4d12c14c35e77a96d4a0f0f38044fa51125991d655c85988e150f7bc3b8f9c69e6b1df46feafdd74aef1e91b7075f45dfaab28adac7a0cb3bfb5b11bc21e3db880448ff78f6f32335d218e2d9ee5a99b64a2649c66d7b7385bc9a7ae3fa44f937128e589f4fe99ea601e40c1b61c53c06657ea9097be13d546453d5bd2864db7f26ed5167d9268584165798aef967260cf8f96dfb9054c07013e1fbf59f550c43017f753ff4ee7afcd47e0e7f682376cff563778e062362dca0c7b1a7ffcce268f42832d75a42b9358720ef827a218221810fc8c28f10d5fab56fd5cce327b1c8d5f6b94225a97855a85783cd9e0b15dc05317d4d70cce6c010205319985ae0e6cd9d24e71c7904d3e8aece8b90aa81eca459c4f2627556dbffa0126b37bd07307e7bb8b01d53cd5f68900ed066392f376806b56790afc249766cd98f9bcc3aaa69c22fb5acdbd320e550131ce16654ede5077043db69a541b8568c715bfda43ea72673a46d1657318629dd83843c60fd5f296f5e26f5aede395d4f46812d977b1cc8a0f1396319a196268f1904e7c9b10e4c191b5f233074dc047c8a1d4733802789a22c54b8776d877dd8995b6d1e8d22f2efd4260a50eb4fc86b9c144242630217f1f2ea75981f4cc02025332c1683a60228eb73d10ceb179a59d11c00b55976fe4ae48e4a5b2a6ac4718923c511d241c63574065959620653cfde157ae5494ff4d2eca43ee70741f13eb8e19875fdc265e52087973e51d374ff7f1ae8eb386347749d39c886f670fd580ce2f24c1092433d76c7cc030a6c5495665dbe0909eccf8e0f77b268fc4b87fcac541599ae1ceace33f50b02d952a7c60a1dbfb75dfcba104f41c85a7133b2d97617874d8ba8f10ed5b5d1d5798d495384088a6d6a6a4af3c3bb755c5806bac3ad273af1dd58a6ce1bd5f5a9f9d2e2b24e2ab75ea9fd8b631ea29f07d1e90517f1690a110530aac7b29c8fe468afc2be93d953d5b172e7c8668a2658f0c95c96043ce03e5f57857e80011117ecbb6f10dd0e0c3deb269b24cf46f5d4ac875e8bb461151cfc66b69ad8d15d2a4ebbc247a20983d94b6f92701ab25bcdd2b768ea44b3c009c150d8aa71fc4440ac0ab6622e29fcc15629a82f3e07bca6eb6900f2670b219ef2ba12edc1a76b6892efb025e38a7a7b1f0a6ac36caa6abf4851ca811e795ba710709d788532026bd134f7ae9c5f3972a9fbec5991f9bb1747eb4064c66eb2e4161c901befab36a9bac48d9b77516a36a722dd705d0da3db493f72bd7195ee8ff99b4626b857e9e34fd6f29f077eb2add160266f7364db4f2b6c39331352f95e7377e10629f9478b5ee57165ff0cbeff7c6481c7be82cd245c462d0ec9c79e35fbc6dd44c427c2a85ce5b79543ea50dd909d59f7de80467aa0e88c8dfeabe74961db74ed4fe9f04454d21f4aad89c26da4a6f5299565edcb1991f9c9f28271604b6540d0556241e67a4d613f4fb0c52ef437c8da0c5e3bbe4798c8659cd393bfc7d10a13edc9c18ab6809cde93ae805c6ee2b3af72ac570678bb1dc0268ad034b18092b8bd9c6f97af6ef0b9d958099b5fe4ba0dd08f004e7d36aee2eedea403a004486eeb22ed71cebdb3413106c7bbd826a7c6c4efe4cc0deb1861212d2bb535c3adefba28ebf3623bf2782bd4600fbcc6a9df20002a47c54cc660a6b27211a8d3dd0444e1a2298260ea6ffa6088ace1590ae7ee9951f7f620e55b49beb0ec8ad1262c98b1ec1b4fa75fd1ff4931b71388e07b31d699246ef6fe59bba6f69b7111ea73f51e685fea3798d2d74fedb900c9ff6ba2cabd150fdf936eca041eb27c38c529767ab14f9b1f9b694c3f2d103779fa3c5d2c75fd287be2fe4169dc05951895b884247e65e8a88ac6628e1abada705287ecb1b3441402dbd6bd0550042e5ae6502d771b844ff46eaae6c61bee5f0ecbd3c61df";
  const Transport = createTransportReplayer(
    RecordStore.fromString("")
  );
  const transport = await Transport.open();
  const btc = new Btc(transport);
  var tx = btc.splitTransaction(
    txHex,
    false, false, false,
    [ "liquid" ]
  );
  var authorizationBlob = btc.serializeTransaction(
    tx,
    [
      [ "6F0279E9ED041C3D710A9F57D0C02928416460C4B722AE3457A11EEC381C526D", "00000000000005DC" ],
      [ "6F0279E9ED041C3D710A9F57D0C02928416460C4B722AE3457A11EEC381C526D", "0000000000032E74"]
    ],
    [ "authorization" ]
    );
  expect(authorizationBlob).toEqual("0200000001e46aa5d11fb7f2243e75bbd90ad94e5ae0d1992c4a5c0d6ba71a77e73df8e23b00000000ffffffff026f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d00000000000005dc006f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d0000000000032e741976a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac");
});

test("liquidTxAuthorizationBlind", async () => {
  var txHex = "020000000101e46aa5d11fb7f2243e75bbd90ad94e5ae0d1992c4a5c0d6ba71a77e73df8e23b00000000171600142851f8219e77b0f3ae8421a8274168c743e574d2ffffffff02016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f0100000000000005dc00000b547995d08f8fa9e87e122548afc2ea80f552aee8e45a44df4cb81292fed26530086bd721b7048f58fc925f56b0642e107a492c9509b475186f7fd573e47a500437020129d9733769531b80adf2a6ab2f8e212beb26f94ebc2afdb43d5b04cac794b41976a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac00000000000002483045022100917ccdbe993dbc4c0bfe0839bf7df16eb481a175c60a7badbb676145e75f924a022012a868a2286420a3d0793e241c4f767a95c985db7c44a0c8a0e872843fc230c8012102bff933ba22e896a0cc0a0834f11c6afb63995605d4def392776a26535cea8e9b00000043010001bd2e6fb69a23e881376f7c692de1aebfd700a905c8a30b493a855685e939f870adf7d6deae5197ddac0e685b0030e76488ec549d4467a4fe1d8e814b3a453878fd4d0b60230000000000000001ea10015893fbe5cadd09e8a2944bb85a3ac04a65a345fbfc5598d5590624603335faec0351b03a46b5a9cc763ee1769badde123ec6aa62c9c0f9f62a868f8c38b4e20a2abd02e74ec5076b38d7893d8a7eb6677b1fa4e7b26716672e059d4b2d4bb965eadc0b1f2670ac51e8e97d9d5c1774c07ea5555ccbb27f7ebc3d7aa0a8eaf2229780587d2289724cc9721d9b0db71f799d59422f95dda24aa357253fb1b411f0538646120a92227e13897dcc8627a6a915f568e9a4ad56b165002c4e9f8db6d2f5c3b6fa5f81851a7c0d70360e4a6504eab5761d79a992f1a9f94360b20027c6fe190deb6bd1b15014f33d6c958b3d8b33b2a7f8385674a4c043fbdffbecba492c5fc8e0bbf2f6d5221a6aae302454b902e679f7e28805a7c351a4e0ce238857ff53c27dc390f3d5ee56d288e92e88da4f51a38e509886fdfba9c957eed31d1549af668bcac6e62886416e4a0ac99c873d03779c5a19ee154ba8c4b12e689e095ea606c024d7beec052e451113dfe1cbcedc182f5434c490d867c3d1aa0d56845b098c87372131e898f74068c4ee43ace49029fd2903b69e0c7fe01a19fae0436880077818cca0c2a8f01975eb3580ce89ae8ffae76bf01ee77a576736eed52849b9584a87eef8b05446d34a33e77ccf117a6aaf3acb0e290e8a3cd5020a6ffe32879d81dd473d0c960052d67825341b1de30b8cea5fe94b9f024bcd6ac2f5963d0ee69137b08714b168d4121837e490bab2815e384d0d15c6d98d990ca61bf648e6fbe89c4b5b22eb7ad68e1688f17fbccadc1ea232f7c4cc10348b9f32ac1ac966c85a7c30e7d2f5582d2d327f106197f19994b23c76026fe034f2e90cb0c9c85ae5693d3f1f9adf9391f70a3d50e0b2ff0e5fe6062e2e62689e5eebb3cb1728b0f553bc5bf288f178240ec4c2028387be30cbfc7d95219e6aa14df11e850c1eed06c3b4e6af58619f4ee93e826f548f6d4841e345215b97b90356d641c367fb478a7207e170fba9d9cb1eb75bab69ccff6f83c28d48132432571074503da5123f09f406a0b632b03d18d2a6320da8b51d46b13daedf69054f352a29bb7e5b95e14f0fc8f2f53478a61d2e754aacaeb7d1287eee4d74b0892263d09bd0423c50940527d404bbe1135c683465553d558f79c00e6cd88ba833fe72732cb624e7c432433236e2f80c5d29665d909059ad1b1dd17b8a5e1cef0bb6a3ff10908435956c82b8347e0871b36d0f1d7b46c12ac2454af4412ac5675621b6feca07730fd14cc0f3d50d6485e0b59ae6abaa064e0514b24c57abf5bb20740b15ef6d64f249bbda993c8f90a5235a7170572cc5e213fea65cb9617ade120349cefaf10e0a945e3ac039021a2dc3652070cc4bdfcd5e2d451bd6bf28f25e4e68f5832b21566829fd37500ac1ae6429132e97278a2bf82074500f5676dcff3adfdefc88daf1a81ab23db5fe7089154219a258518fb204b3fe9ad572bc47fd4c5a200a14593cc7efe24b7d98144ae35d4e6328c76c1807168a6d799ed3aad5f4586bc1437d7cdf38b026b9e131f39d0bba348b6598b7fbc9f2c9ec0bcc03c28329b416bffa285644031d489e86d43ef12b3f42e76c36e5ae9df1f3ac0f1d9cdd5d4d7c446b19d1d8d9a58c93ae27ff8daab5e49104b991b38ef4dd848d9898d1814ebf391bf57a9314f298268c5fa884c114e83a87210aa8b483be9c3f5a4eb345af951bfde6157bfbbfc7fae28297a534f2651d5c4f11314b29859510d8fa99127435c30c2e99a308a68e6b699967fe5b5ab35146b758e876450c1a03b9b90fcb7cc05929680ed282d93e53c1d56590928b547e10222db9ba6f2d8d0afaa93af871e4a8f9d9e69f07fede10ec6f088fd5195349e566fa420583822371ab2778327019548de0ed9cd4e412b14fed14f768a6b5f11ac26637779dac567a2372ad033fbc9a3ada97b10d6bde95fbe665215068a6a9f29872d102a14c7edcd0ccd19f47c09ddef7aae4d1a2bd6050806c662e4669391996c869bf94d3863589f96b02be28d045ed7eaa92c399289de5b193fd4db5da347fee11eb9b1ac901a2ad542496b8c869e0c55ef27d8b7b4905fd24d652789dcc89a59368f0ca0f0ea8c99b4d12c14c35e77a96d4a0f0f38044fa51125991d655c85988e150f7bc3b8f9c69e6b1df46feafdd74aef1e91b7075f45dfaab28adac7a0cb3bfb5b11bc21e3db880448ff78f6f32335d218e2d9ee5a99b64a2649c66d7b7385bc9a7ae3fa44f937128e589f4fe99ea601e40c1b61c53c06657ea9097be13d546453d5bd2864db7f26ed5167d9268584165798aef967260cf8f96dfb9054c07013e1fbf59f550c43017f753ff4ee7afcd47e0e7f682376cff563778e062362dca0c7b1a7ffcce268f42832d75a42b9358720ef827a218221810fc8c28f10d5fab56fd5cce327b1c8d5f6b94225a97855a85783cd9e0b15dc05317d4d70cce6c010205319985ae0e6cd9d24e71c7904d3e8aece8b90aa81eca459c4f2627556dbffa0126b37bd07307e7bb8b01d53cd5f68900ed066392f376806b56790afc249766cd98f9bcc3aaa69c22fb5acdbd320e550131ce16654ede5077043db69a541b8568c715bfda43ea72673a46d1657318629dd83843c60fd5f296f5e26f5aede395d4f46812d977b1cc8a0f1396319a196268f1904e7c9b10e4c191b5f233074dc047c8a1d4733802789a22c54b8776d877dd8995b6d1e8d22f2efd4260a50eb4fc86b9c144242630217f1f2ea75981f4cc02025332c1683a60228eb73d10ceb179a59d11c00b55976fe4ae48e4a5b2a6ac4718923c511d241c63574065959620653cfde157ae5494ff4d2eca43ee70741f13eb8e19875fdc265e52087973e51d374ff7f1ae8eb386347749d39c886f670fd580ce2f24c1092433d76c7cc030a6c5495665dbe0909eccf8e0f77b268fc4b87fcac541599ae1ceace33f50b02d952a7c60a1dbfb75dfcba104f41c85a7133b2d97617874d8ba8f10ed5b5d1d5798d495384088a6d6a6a4af3c3bb755c5806bac3ad273af1dd58a6ce1bd5f5a9f9d2e2b24e2ab75ea9fd8b631ea29f07d1e90517f1690a110530aac7b29c8fe468afc2be93d953d5b172e7c8668a2658f0c95c96043ce03e5f57857e80011117ecbb6f10dd0e0c3deb269b24cf46f5d4ac875e8bb461151cfc66b69ad8d15d2a4ebbc247a20983d94b6f92701ab25bcdd2b768ea44b3c009c150d8aa71fc4440ac0ab6622e29fcc15629a82f3e07bca6eb6900f2670b219ef2ba12edc1a76b6892efb025e38a7a7b1f0a6ac36caa6abf4851ca811e795ba710709d788532026bd134f7ae9c5f3972a9fbec5991f9bb1747eb4064c66eb2e4161c901befab36a9bac48d9b77516a36a722dd705d0da3db493f72bd7195ee8ff99b4626b857e9e34fd6f29f077eb2add160266f7364db4f2b6c39331352f95e7377e10629f9478b5ee57165ff0cbeff7c6481c7be82cd245c462d0ec9c79e35fbc6dd44c427c2a85ce5b79543ea50dd909d59f7de80467aa0e88c8dfeabe74961db74ed4fe9f04454d21f4aad89c26da4a6f5299565edcb1991f9c9f28271604b6540d0556241e67a4d613f4fb0c52ef437c8da0c5e3bbe4798c8659cd393bfc7d10a13edc9c18ab6809cde93ae805c6ee2b3af72ac570678bb1dc0268ad034b18092b8bd9c6f97af6ef0b9d958099b5fe4ba0dd08f004e7d36aee2eedea403a004486eeb22ed71cebdb3413106c7bbd826a7c6c4efe4cc0deb1861212d2bb535c3adefba28ebf3623bf2782bd4600fbcc6a9df20002a47c54cc660a6b27211a8d3dd0444e1a2298260ea6ffa6088ace1590ae7ee9951f7f620e55b49beb0ec8ad1262c98b1ec1b4fa75fd1ff4931b71388e07b31d699246ef6fe59bba6f69b7111ea73f51e685fea3798d2d74fedb900c9ff6ba2cabd150fdf936eca041eb27c38c529767ab14f9b1f9b694c3f2d103779fa3c5d2c75fd287be2fe4169dc05951895b884247e65e8a88ac6628e1abada705287ecb1b3441402dbd6bd0550042e5ae6502d771b844ff46eaae6c61bee5f0ecbd3c61df";
  const Transport = createTransportReplayer(
    RecordStore.fromString("")
  );
  const transport = await Transport.open();
  const btc = new Btc(transport);
  var tx = btc.splitTransaction(
    txHex,
    false, false, false,
    [ "liquid" ]
  );
  var authorizationBlob = btc.serializeTransaction(
    tx,
    [
      [ "6F0279E9ED041C3D710A9F57D0C02928416460C4B722AE3457A11EEC381C526D", "00000000000005DC" ],
      [ ]
    ],
    [ "authorization" ]
    );
    expect(authorizationBlob).toEqual("0200000001e46aa5d11fb7f2243e75bbd90ad94e5ae0d1992c4a5c0d6ba71a77e73df8e23b00000000ffffffff026f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d00000000000005dc000b547995d08f8fa9e87e122548afc2ea80f552aee8e45a44df4cb81292fed26530086bd721b7048f58fc925f56b0642e107a492c9509b475186f7fd573e47a5004371976a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac");
});

test("signLiquidDirectBlind", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
      => e040000015058000002c800006f0800000000000000000000004
      <= 4104bff933ba22e896a0cc0a0834f11c6afb63995605d4def392776a26535cea8e9b4703133bd7dfeb712b3f64196b4306eb5af8fc19bc1701960c43f1295ade67b022507a77614d4271727332556337314e56585548505275704e4a6f53624a5053706b34eab942576f0c24b0125dbcd96e5cd0484a2f111a5634c4e1683b621c88d6f5c99000
      => e0440006050200000001
      <= 9000
      => e04480064703e46aa5d11fb7f2243e75bbd90ad94e5ae0d1992c4a5c0d6ba71a77e73df8e23b000000000869291ddd2ff53c38c1086a229d1ddc6a486a92cf3ad3fd42d32c90623df1c9fd00
      <= 9000
      => e044800604ffffffff
      <= 9000
      => e04a00000102
      <= 009000
      => e04a00002a016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f0100000000000005dc
      <= 009000
      => e04a00000100
      <= 009000
      => e04a00000100
      <= 009000
      => e04a00000100
      <= 009000
      => e04a0000420b547995d08f8fa9e87e122548afc2ea80f552aee8e45a44df4cb81292fed26530086bd721b7048f58fc925f56b0642e107a492c9509b475186f7fd573e47a500437
      <= 009000
      => e04a000021020129d9733769531b80adf2a6ab2f8e212beb26f94ebc2afdb43d5b04cac794b4
      <= 009000
      => e04a80001a1976a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac
      <= 9000
      => e0e680000100
      <= 9000
      => e0440080050200000001
      <= 9000
      => e04480804703e46aa5d11fb7f2243e75bbd90ad94e5ae0d1992c4a5c0d6ba71a77e73df8e23b000000000869291ddd2ff53c38c1086a229d1ddc6a486a92cf3ad3fd42d32c90623df1c9fd19
      <= 9000
      => e04480801d76a9142851f8219e77b0f3ae8421a8274168c743e574d288acffffffff
      <= 9000
      => e048000062058000002c800006f0800000000000000000000004473045022100dc0cdedb6f32a38898d9e2ebeb6227aecb0ae9c22d4d7fa476fec27a008f2569022045efd3a5460670cced0b07658807924ff28fbb38cd9d1489455a672b156743010000000001
      <= 3045022100917ccdbe993dbc4c0bfe0839bf7df16eb481a175c60a7badbb676145e75f924a022012a868a2286420a3d0793e241c4f767a95c985db7c44a0c8a0e872843fc230c8019000
    `)
  );
  const transport = await Transport.open();  
  const btc = new Btc(transport);
  var tx1 = btc.splitTransaction(
     "020000000102cff2da20f8e5b8509efa330427576c537c68e9857b043a0025613772e7755cc1000000006b48304502210080b44399b81a1da40a2e558f2316b99b8780fb0d53fdba00fdd09f9b5ea0991e022050e659c7c29376577b58dddca67b6734e4c2130c7cdbdd39d75d9930ae89f635012103b3b0e8813505e43b8458fc36cf18a2ec03df5bfa4b0b2c0f4fd87155c9350ddefeffffff26cfc77b1c2e223f874431efc0c2609c860e70b4eedde2a377db2ef796814179010000006b483045022100a2a643d901117a0179426398d1fa4b7a140b0204afd45c5ffc7a2513f93b4de0022013529c986890cc781ad7bc9f1760ba389a6af0bfd8a1819c046c6ed9fe03e1db012103358a087d1e6c618254a46254ebaca75cb239179ccedc118151ab919179b33f59feffffff030ad0be2e9f3f6d8e57aaf95d73063ff2b9a3d4a43e34702f7f9407466ef073e9760869291ddd2ff53c38c1086a229d1ddc6a486a92cf3ad3fd42d32c90623df1c9fd029615199ad0cd0c4da1ef7485616077bdaf42c802b891976d215da8d87353659317a9143d0bc0a47bb048ee9f8e2f265658a5ac845dabc5870a741e7c88fc62c426964ab5937ee2cd105770fdab69cc7d80582adc5ebb4dea3c083e5cd457ffae83fff38b18c1f3560aa8eaf8b109d527323b8df53f052cdb0f0203e65ef1d60771ee222bbf3aad70b72de46a2fafdc4c6fb3f0fa049fe77ed42ee01976a9143c6dec016103bef153931464b03a790e0848b26b88ac016d521c38ec1ea15734ae22b7c46064412829c0d0579f0a713d1c04ede979026f01000000000000083400009c950600000000000000000063020003b3df8acac19653da7f6270429447d7e1b38e6c2d0b92b4d578e67fa507ed1db5283779e7b2f59d04be3e05f2743a28528bb9a89a244f122feba497ef412f58ca8c24e960c10eb18ef29d70763894fc471db1667e409835a8f3f01f49f644aba7fd4d0b602300000000000000015232005c9693e00f296a4aae19ce6501e236a65b0135f2907bd3736cf471e18fe306e795e8aafed6a6bc75af6a8042b246dda6ce0df5196f3f964f9eb47a5c6da32be5b9b9e974b103918d4279c877b98c1e9b7ff1b54e88155f87cd2a2258b1a6deb1121fa3c725cded84d06b1ca937cec69a64358242da95db127297641a781ddb5f69aced06489195d99baaf17e1d3e59a52b3e8680347e47e6584744065a80e3619905ff36215aab44f6179bade9020cc460ef93362f64d712069cd6b5208c41a4c1d839078254d7eb5f6b4850135d0ff2586e4060980b0705c96644e731613dc42341ed1fdf0c69b4615fdc9703a4804971404dc245478b8ae235aa5da880e06e06fa69f7b479f72eec63e11fb883672d12ba1141b9cea488179afe0ff0a3f9a6cbb41ca28da27cfd3ef1b3807e184c54aa3a836ec9dfddf3b4226536bd03abe766ea62ba5d4f26b5e6ee9967016ac98e288194b89fa9dc4b352d454166d294e5b6a4fe16d2a309862043aa3d01bb2caa6f309902e12ffbb0dd2767e31e1af56ac75cace803c7ecaae3f3ef2b32808faf6df1fbcb7dffd097146512ed727c73a1f19b9cacee7e5f6b6c548a6a35e68ca59c1e10cdc06e2bc26c474bc9e93af32b9242bf1a2b1e43ee39f427500e70cdb84c1b0a41671dad3b8b314c65fe04a363a8d79acb4d28a052048450c807770dbd801a1d358f2daf1cacc5861946b3126edfc62fc8071f473ebaaf530fc52a052d1f2ba7d70df46762ac50828257c24f89c8a83164432cc65aa75c547423eb6a55501a4d8527dddf9312463b9f92e27ca9d6b979bc3ff87f9599ab7a343874cc75d4ffbb2a34f11779ff642d01f7060ae4682b29e86d144fde32ea1135bb9480df7e77fda452abd9d11152ea321755de5fe9617ec4482dd18a136ca93209e076025a90b663dc28e057be8ae2a571d68e539c29d0d5319d0ef4d57128a48a0e1a32151886d2664ed822b7711bf17a60346cb3f1ef714ce9ac2f39b8210889af367378731e0d19ddac44a8733c7b3d49c0e6c5ba8003daab81af79000e67bdf2d261ebdd7ae02e3c4059021af0a3d9be5be5a2f29f917495380b121aeeed3236a5bd98e83b8e155632b08809e8779159858d9f60c1cc93d76456715094106c833b675938890af4c6c8aa26786d58407972e16fef9131f7c3bee41a252c3023beb29c55f4b57fca7f56f25626c9b668797653dfea81d9473934f5291b9dda6e2228f2b67bc57014300991349d5baa91f500e0b6bb384954c243e8300ac73213890782e410124e477d0389f6b85cd3c4e1549b584aa9daff51aa5915f9d588ee40607a7016dcbd60552d6e980a5892223feb33c07176a51c28a3b242b0f5e10f8cfb5ce2fadade497ea46d3ff8babd385772e89f7bdbfe55713e73d8f690d766a988e60254c205553f30bbd1f8903935bffb4e1fad616939989739f5c44919977d74b4fe44a127ce53c0782378bf1a4420e901b998994a65787e206357b1241e33d4c4d5cf23d9913e80b161e9de8fbda9040b7f87e306582ea81abd3fdff0e93dad926b49da4bf390441abf0f48a333ca2197f0b74127bbad8a3712cab0a4458b011e2fd559f5b42efe51d3ffd5eaa8c69e861a7d4aff589b8b3414e297607adf5b296eba6726bfe60f0b09e16ba751c04eae302ce589bb2e70b7dacc9ecab4f88f06997d33d9e07baebf2e95ca9d971b47b2e0a9c36b4ef60c1e4b0cac1187a9474c615b5daec2463949bf940de549c17cc6d6542dfebfced4ddc05e146179cdc120a7e6aafe5426baf89579c369e2c3f6fef1c4fb5542ab38b491e6b975a0ff69eed469022fc38e9dfeaa09b3d60600c5d3b25d699c19a0eb879cae5db07a70b54db47335052b44d14716358ac6c12b940351e063a265b6fb837a945fc132f33619d4f7fe0ad6e33db25cec1866e67d622b71c8019cc1f55c4b104761bf44a630bb2217dfc118b1d41fd7dd5f9c045636b6ba5a14d47e32acb977210f1e3783b3505bdf7949b7f65e82ba659bc4002013f8d9674835b57903b773ccb3a0f7b34c1bf5de9b9871c50197e4c574658ebf56b1990cf8f00c96b9a1c671af11081672bac4ac4623b23af10cd22a1da6d1c3dce8576cbd8bb65c27629219b12ee678184702e597966714d60189202ce5f475a435ea2124f3644ef34a62da00d5156f10d7828cf4038154aa218b77bf44317e53c6ce5ec62e8564362255d587bfb2c722a30e45ace4b0f9cd98b55c0174441bff656755d9e178a87daeb95424842074b6aa2f01edd8e0c8e678b92e996481392ea6186b709bacb514f5c2477ee36730b5270e3cd5e19455b6e3c5f38f4d74af42205c2fa725bc7a5cda1439614bd5bc945e8648f8e5c332207d8ac4af3b0eb89fce295d84e1a0301187ad1b1c588367b15f8be1fa0cb03b4c885b0ac93bdd774951f4b406973076edcacb22b7588153493807c82bb8be769b62d4becdb4df088021cf9b162c73e1feb12c33f66d3ff8022f56a8d49a261ca09dc364ca20d0c15d43f45decc5efe0b56c544a25e5af0d1ba66642639d5cc4f3f5eb4839a682c71027e58e4cc4c001c399608ccfa66a911213ad8f892d71539c58ba26a21f48812a13422e3e17f7bd16f0635148fd7ec8a94a7cbc5c18d930e001ed72ef4b3dfaec31e145eb47027ddac49399204ebd05cdf35b46fa436ccf761d92685b7a63bb13cc22fa595800b9b4d3ee52bfeabc83b5b1b59d7afe74546869947069e9848741fe25d65c1d98ff3594e9dbcf3f90c83b814a801069edb4006a2af8e1f261ca01b8c7b47564fd3e55421022611859c30c3b4933c2b37e8f52e961e949339d7af2b8bb98d8f7f9b606d94580b413628316a65cdebec5bb43e3141bdd8113bb02cb93ba35bdf67320e978d29ed43960a9cd587856085540072e0e6ccf3bd408a61f4ccf06c02975cdcc519fa5b093767875516a5fcb3842cab286a3c340d410c2d554f745469262829976c20c73a39b6aa02e0189cfdd9afda2147d09c93b07132dfc24e93cf5fc379f0011f0c142fc6f99897ab8949cfaf2e97496090d797bbf61ac09ae8ae208a4f97ebd1bc2bbd775888cd49c5a0a1c1fe07eae643f1c2f1a12a4fbaee97847f649a5cc32474a3013bb933a51813a1cb3880c1672e0c6bee975f76182fb86f480da857745f7008898161db1ffc6156fba7ca920fc783f7c349543903ba7f1bbb72d03426097a081fce5f2c1c3bc34f9d838e94e91e3d5ccacdfbc577fbcb2d85510efaf0a71b9ef34c22d51a8b213abe53bcd28c863b25652df2924cdb57dc1b3469c5161a7392b2b454ba5f459865f8c6df81036a37fde81bc89e92c81ccb104238492e31aa7c879df4dd01dcd9b6361beab40ad7cc4511be85de2ea19b480b6b2bcdd5553460c02a6cea6eb3610f4cf18aa023759cbc826da0f63ceed6af824537f2fa5ff6e3655484e221972169be45505e1ae8b33d59258abc20ddb98718d2c9a68a6a91bb2056df0103e667fad06af5761cc416d6aecd88a4bc51db7ede859988cd4acfc47454a18ebb9f7a6dfa2319ac89ec19a7469f3512b22f37e5d178e3b5f2351ab3b293ac270aea08108a8f57f0745af87f4f092c7bd713f2e290b1201532bf82c10652d06a748ba83035af331bd1d077fc9f98f7a485efca4b2607ee6c0e39d5722ec2f321482bfe43b77d58acaf21ffc9ad7832b8a9f6649e2bc37a76e5ab3cc8911a541665bf9b8d9ca53c3ad4336319f8100ad21f174fbbc05af82c0e277d29a5155ddbeebb6ec5d0a06a45dbb13bb802744281d08c606e875efe3ddb3b60d5d1039d185e6b6c4851201fc78dd1b6043f97b7e7c93833900751e8493f7df5736099a1dc650595e68de5fb3c49c2227f88604279c8a28091103240897bb1dcbe56a6f5db94ec03e5ae49455c3d2523e5da7f9311b05ef0c7f199c75ea929262aebfba83ff78d8f402ca70aedfb8011f86aa009b1ef32597369babdcfbfd0a4a52acc8f791ecb402eaad0de88650cbc7584bdc4707e6df574e0972c5552a7fd763078a01f5c8983e5b872b9241c0f87a5ed9fed063020003a15a0ec496fc0b15f1cbf48f78818bb032be8d83eaa394f3e7826bcbc2adf30b9079deb2749f8fc82bcbf490b8dd06528c3b4c0e84db24ef1cec7920d7f1d8dfb9fc3ca4b6745c8e8d8616138c9ea501e1aa07412b3a84c7ee6e24f1ec83f477fd4d0b60230000000000000001acaf00371aed1fe5cb818b3cc166ee9cf159cce9b0457a3f1c657488d13e4c643bbf51856f533840607f0a98c1dbe3a4c2afdb6435ef3b8e19f772b281c891b2f9827b65e6159455a35e12c928d0c4a0699c4fc8e9436b51a2806530e4e49dce8f4cb431f7b183c0f6b6f47956c92391ce00264d357369b49ddac557915bd05622003bc5354cb49b25d7eac47caefaac6ceb72291e11e58dac2fc5c4cdad3d9da208301a5bcbdb11f3681fba60ba889a06d357ea800003aa9c143bd14135df18a52a1254e9b98f7b2bc4a2b9c45e47d8a9dcefd2404a9d1302b54ff5b0501b362d75c5d6b8d261ed28add327db80c8dca2585ff6d83f834ae8795e4e4beb2b2d0c8e116f1cab40e3de97661d897c4c652c30d996e1d32f4b5b1d82f701457b3d508c328d2552343ff83488f12ab6729b1ff1b32488e84c7d901d5fe889e1e2039a9ff140549ef85240901aeeb0f422ddc5b5331fe53cfe08e5d537f01f6e2b3f7db4d3dccc2ab21bec23bb586651cda654d68edc8ea24d6536f4f3d632b8600fd91187dfbf1a63260e906ac39889d476f589be02255a9f2bec1dd4e2d568322cbcdc79bfa456cc475b5580a07e35fe18ff2cfbdaa2d58676c56ac6597b0b2b66f3f4fa9f52ed389ceafd63a4683ba6a4ddb23c08785374945e2d30b49759f8c7062c8bbfec33c7a537041ef38fa99d10951278132af5cd192ac998edd18833eb2e93b52d71ebb05581643003a13da708b5519c271cad4d6dfffe5db3e9abe7d0e5c1302bc3058153481ca95625551b0057875455790254724b9024c42a750c44187cdd6f55bbcbda29f08d958023c88da85c3460861cd0a9d11d35d82641c03b039695c96969b392ac0e6a05b52bd8393c71cf98dd4f9ad8b77580e3bae5bf563130b94262a338a11973ec3601f51544a2e784bd56f8de73fcca9039d7b31b416662b2b8438f9e4a6db6de9f31ea1deda75115c4b30460b1f0251d7158cda9729e6b0a91f99ffcf6fb4624facbcea53ae6987dbb9c4a56a36378b23ac8f5f14745919f362493650ed543a431f8a88a54a72a259e085b3da23be49583bbe8d6255dac2addfeace86eac576fba9e72220b5f03ecb1094019d0de34bbc19c17e46a4ac38e2f65ba0662a414a3e6bad9ec19a356c916afb3130dbf78d0e2496c14223f6893325163c335cd43bc472b705de4360aabcc4a2ba3b24450e1f680362820b1ece3c4f22a586fceb070757569cceb972c8cc0ec70e5f1971ebab8fd3c0399d7244e3bb2d9b4bd9678eb0a63231ad8134b979bacc77a462b9e7b7dd5b77e0005c74ead2d8d56501c6bf08849826cb9fcce61686278c7260f0705408dbe0c79a345ef43312496aa330826a8aee71f30fa71c66c75d834ae04f2bad2cdac86f2fe150bc3ea63a93da12f3021cace8976e4135f632816967d9bc7e3f86f363747a4f87aeeedd38318c127f39480f557370860fb7a855ca8b0ad202da421a18519d95bf7b77f02da0e701871050985bed39fe197219a25665664260d236c9058a08c2c6b6f0bd781fef9f41dae1bdb9d52852e3104915f30507b92b1ae10e2a1366dd0adb30e0cede8b428f799161a2c65426bd268b35f1461be5494f97e075e7cba9644d54c593d96f88f691e041dd6100ea9e5156d570f214905417a94ee5b8dd0ebfcf2e3a9812abafe65fe41f283928bd0f01ce196d606bd8621e213a654ef67f304672659027af33a060ea658f6993caf5a8291480035baa934e3f2be9257fd6ff82f9511bd8ea60eb01a62d9eb2aabaaf0ee8c37371ebacf51633ed162fbbabd9e3533a8dbe98eca08aeb613e27b8c0c415475aa4af6ccf2f5866eae51efe4994d2d36a40bd0c193c30a532cf84e671b6ece1caafba51051b15b74a73c3a083620a1465535f42565bd7478bb1966b40f03989047e03be7f21069a80290cc8001baa2e700f22563d3fdb6b5a1bf9b7db28c27b8b37d333aa6c71746fb050dbfe5eccccf85a0177ac6118c9b2dbcc37a91e71ff408f0e60d4f87edb5a79821d156baabc845ba47196ed142ee81771c73f3a0733ad5a6c8192587cbf857d59e2269dd9ccd3fde696506ac519f6e22379f0393029a9f84f321ca253526ddb07e5a8f700c8e508cdb5267473d55b1779983b86ad9eec2c53d1adddeee1ea41409bf40b778abd9aeee69a7a06480eb8a4019d012c834bfd10c63cdc216b39515cee0732c56cd8b1ea5cfae9453551479f1ee15675ddafd1ae3539ea4b768b725be5a9cc5bfdd328f16e21934a8cceb54dd1be38787373cee191e950af1b9e17739f8a665feece8f6bab6d71886c3c0de47a07dda275418b6f1f31932a8f8dc945f56937c55d7fab12de4dc8919b2fdf089fe07d09a205886ed90d8e731330e1de82ae2105ed513e0404a28069083b0e9d3fd0c36edd4a3dbe3315ed077723d15cc0a93c08b2075a6e16ec9379465934de1de7e89866b64117873b704451e25d192a4abe58caf0a18265e17f5c34a61b188514791728b008fd22825a0bde165acdccae8062947cdb4017aaa783aad117832281d22a14696326355c2d182b99c0fab44c10db26e22dc9f9d615dbae47397f16434c4018c0a44973db8ab67624795de3cb218ffd0f0f9e5f927868ff9ce37398e7b4a80986c931b7e7e9897373df172a701072a0058808193b64feecdae4ef3f79e705739d7c400df94f84afb41f26c4dcb9a1cf9778661f51cd8cbe0cd4ff931804fa580c476b5bdfdcab9f1b7aae78634aa302eb0054a3be7034e4b68bfbdc15986261f21b361bdc96918cfbfbd884493df88fe92fa0eb17a96f6d7dbd0ec8a708038c4cac051e547ba806f57f25f82400b541bb168c060e8a37922dd668bed269d028981039a915003f77d1a30c4f9f1e14c44b1fc5737a827bdc038734b940939dedd409415271363d43402b514e2383ae120b0e7fc28a400cc967c129eb0baff7fce2d8a3f1761a69fea04e9c46dddc84c68dcf60b58563eeb99f694a1735ebdb9cba35f70f482831f182dc13d122a52cf4ef686ddaa3d6fa34452c6d103e07a9ddc0d9b765711e4a1f067b2ed12870d2b811da197b9e645ed1ee22f992ca79aa2bfa3230fb09ede60b42b900f821c4294f6e408572a96936a0996e8f49a55454c4b5317dcffe11d588e9fa24038e0dc7e52e274ff9535ab7e585fd9dae7b3bcac5aac1e481f9b9d64c14a33133e4b03c7ee91e206011037fd196853e9ff9986f73cbdd1d817a13a0485f0dbc94d7983bd92865d19cd08e6629f2993b08ce478482fc7a8219890eb56bfd088ded3113891c3ff39b831f447d4a061fcd79f4c064e543987450dcdf8dac7adca424618775a8f0718c497dc7165dacba2fd3e6a1ef82f60d31f196b7efb665001a8fd168e81e6a12a6e10bb52cc66c777f878318e809f85ef0fb353fd80ac1000f3ae55816ab958e88f0e6b2d020cacf8fc20e81c1bf38d382362e4de31c366d1ab5fe467d8503151a976fadd45323d81afe753a67847d9e5e53c265cd291c393270e30d1c89115194b77f1ced483f402667adc7424b5d83e64b7c1837282b658f017c87f6ec4ec60c4b4dc2e2fe809aded5d8460d54d0922c74edd7e4e3c92eb7eda8800808afefa54d27721db30b93dd6159fbff0face0741f6594ab7b0dea1952426a940830dc8ac92b90a7f632c00a584923d866d27ea1f764174c986518718856013328bbc5e97ff32a0c8182ef1d27747a420d5e11beb45d3f3bcb43463cbae8289a2c61c566bc0e9f9e2043e3ae773d0d07b7d7f05554f55ee41f554684c607d9d3e1bd597b6e02d8cb16feb4991df514f80ea445e74343dae0a709a9d872d6f865aada311fd8b251b1213338c45b68e8b218f97230da88ec03d1be63184c9fde0682d441b93786693becb319d35cb3a28690502812b770c93f0ce94ca42136abd3ad32d97ccfef7419b670ee21d0c0a5abe431a256e23bcc2293e58c7f84099327e4662c134468258f685ffc860ef67d725e2b651852f58aa4dad172121cff6ab5b3fe69fe868411147f10095c9db37843eaaa00ae5dc64c387cb2c9e975c190a0000",
     false, false, false,
     ["liquid"]
  );
  const result = await btc.signLiquidTransaction(
    [
      [tx1, 0, undefined, undefined, undefined, undefined, undefined, "3045022100dc0cdedb6f32a38898d9e2ebeb6227aecb0ae9c22d4d7fa476fec27a008f2569022045efd3a5460670cced0b07658807924ff28fbb38cd9d1489455a672b15674301" ],
    ],
    ["44'/1776'/0'/0/4"],
    undefined,
    [
      [ "00000000000005dc", 
        "6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d", 
        "",
        "00",
        "00",
        "0000000000000000000000000000000000000000000000000000000000000000",
        undefined,
        "0000000000000000000000000000000000000000000000000000000000000000",
        undefined
      ],
      [ "", 
        "", 
        "76a914af991f5a938a1767f93adac12bdf8f42156a4ecc88ac",
        "",
        "020129d9733769531b80adf2a6ab2f8e212beb26f94ebc2afdb43d5b04cac794b4",
        "",
        "0b547995d08f8fa9e87e122548afc2ea80f552aee8e45a44df4cb81292fed26530",
        "",
        "086bd721b7048f58fc925f56b0642e107a492c9509b475186f7fd573e47a500437"
      ]
    ]
  );
  expect(result).toEqual(["3045022100917ccdbe993dbc4c0bfe0839bf7df16eb481a175c60a7badbb676145e75f924a022012a868a2286420a3d0793e241c4f767a95c985db7c44a0c8a0e872843fc230c801"]);
});
