import {
  createTransportReplayer,
  RecordStore
} from "@ledgerhq/hw-transport-mocker";
import SimpleVote from "../src/SimpleVote";

test("getVote", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
    => e0020000820080000000000000000000000000000000000000000000000000000000000000000004626c616804036f6e650374776f05746872656504666f75723045022100c8c0c02f2ecc5e9de55e85893bf8a307df8c4659c26dbb2734c894438710fb9e02203953b2a9ba78a23354c953a848fab558a9760c58d9685c36c348b4d43c753b2b
    <= 00000000000000000000000000000000000000000000000000000000000000007a39c74f8f44a7f9a77ef600c7c4b86953d051b129c9d80ee94c51ec9cd62ea603304402201d77403ac6c49b54e201b4035095ba6c4da128053561e92abfe6d536853d82e20220195c1e0e977edd6c77754a45a3a2bceb8ec0c220fb1e96e0311c350fdf3d7f959000
    `)
  );
  const transport = await Transport.open();
  const vote = new SimpleVote(transport);
  const result = await vote.getVote("0080000000000000000000000000000000000000000000000000000000000000000004626c616804036f6e650374776f05746872656504666f75723045022100c8c0c02f2ecc5e9de55e85893bf8a307df8c4659c26dbb2734c894438710fb9e02203953b2a9ba78a23354c953a848fab558a9760c58d9685c36c348b4d43c753b2b");
  expect(result).toEqual("00000000000000000000000000000000000000000000000000000000000000007a39c74f8f44a7f9a77ef600c7c4b86953d051b129c9d80ee94c51ec9cd62ea603304402201d77403ac6c49b54e201b4035095ba6c4da128053561e92abfe6d536853d82e20220195c1e0e977edd6c77754a45a3a2bceb8ec0c220fb1e96e0311c350fdf3d7f95");
});

test("getVoteLong", async () => {
  const Transport = createTransportReplayer(
    RecordStore.fromString(`
    => e00200009600df000000000000000000000000000000000000000000000000000000000000000014746869732069732061206c6f6e67207469746c65041774686973206973206974656d206e756d626572206f6e651774686973206973206974656d206e756d6265722074776f1974686973206973206974656d206e756d6265722074687265651874686973206973206974656d206e756d626572
    <= 9000
    => e00280004b20666f7572304402204122ebe65a3b250d0a0b48af79371530fcf49157ad56dcdb1981f05679079c830220514551b6202603db68efc40c56dc8569512bf8d3c9a60a3a892edc214a3ed327
    <= 00000000000000000000000000000000000000000000000000000000000000007a39c74f8f44a7f9a77ef600c7c4b86953d051b129c9d80ee94c51ec9cd62ea603304402201d77403ac6c49b54e201b4035095ba6c4da128053561e92abfe6d536853d82e20220195c1e0e977edd6c77754a45a3a2bceb8ec0c220fb1e96e0311c350fdf3d7f959000
    `)
  );
  const transport = await Transport.open();
  const vote = new SimpleVote(transport);
  const result = await vote.getVote("00df000000000000000000000000000000000000000000000000000000000000000014746869732069732061206c6f6e67207469746c65041774686973206973206974656d206e756d626572206f6e651774686973206973206974656d206e756d6265722074776f1974686973206973206974656d206e756d6265722074687265651874686973206973206974656d206e756d62657220666f7572304402204122ebe65a3b250d0a0b48af79371530fcf49157ad56dcdb1981f05679079c830220514551b6202603db68efc40c56dc8569512bf8d3c9a60a3a892edc214a3ed327");
  expect(result).toEqual("00000000000000000000000000000000000000000000000000000000000000007a39c74f8f44a7f9a77ef600c7c4b86953d051b129c9d80ee94c51ec9cd62ea603304402201d77403ac6c49b54e201b4035095ba6c4da128053561e92abfe6d536853d82e20220195c1e0e977edd6c77754a45a3a2bceb8ec0c220fb1e96e0311c350fdf3d7f95");
});
